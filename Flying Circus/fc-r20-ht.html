<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="fc-r20-cs.css">
</head>

<div class="sheet-main">
	
	<!-- Game Name, and roll toggles -->
	<div class='sheet-topgrid'> 
		<h1> Flying Circus </h1>
		<span> </span>
		
		<input type="hidden" class="sheet-radio-roll-state" name="attr_rollstate" value="flat" />
		
		<button type="action" name="act_roll_state_disadvantage" class="sheet-radio-roll-state  sheet-radio-roll-state-disadvantage"> Dis
		</button>
		
		<span> </span>
		
		<button type="action" name="act_roll_state_flat" class="sheet-radio-roll-state  sheet-radio-roll-state-flat"> -
		</button>
		
		<span> </span>
		
		<button type="action" name="act_roll_state_advantage" class="sheet-radio-roll-state  sheet-radio-roll-state-advantage"> Adv
		</button>
		
		<span> </span>
		
		<label class="sheet-big-label" > Roll Mod </label>
		
		<input name="attr_roll_mod" class="sheet-stat-inputs" type="number" value="0" /> 
		
	
	</div>
	
	<!-- Spacing fix -->

	<div class="col" style="width: 100%; height: 10px;"></div>
	
    <div class='tab-container'> 
    </div>
	
	<!-- Tab Buttons -->
	<input type="radio" name="attr_tabs" value="Pilot" class="tab tab-pilot-radio" checked /><label>Pilot</label>
	<input type="radio" name="attr_tabs" value="Plane" class="tab tab-plane-radio" /><label>Plane</label>
	<input type="radio" name="attr_tabs" value="Confidants" class="tab tab-confidants-radio" /><label>Confidants</label>
	<input type="radio" name="attr_tabs" value="Roster" class="tab tab-roster-radio" /><label>Roster</label>
	<input type="radio" name="attr_tabs" value="NPC" class="tab tab-npc-radio" /><label>NPC</label>
		
	
	<!-- Spacing fix -->

	<div class="col" style="width: 100%; height: 10px;"></div>
	
	<!-- Plane tab start-->	
    <div class='tab-pilot'>
		
		<!-- Rows common to all playbooks -->	
		<div class='sheet-nameline'>
			
			<!-- Name line -->	
			<label class="sheet-left-label">Name</label> <input name="attr_character_name" class="sheet-char-inputs" type="text"/>
			<span> </span>
			<label class="sheet-left-label">Playbook</label> <select name="attr_playbook"  class="sheet-select-inputs"> <option value="farmer" selected>Farmer</option> <option value="soldier" >Soldier</option> <option value="fisher" >Fisher</option> <option value="survivor" >Survivor</option> <option value="skyborn" >Skyborn</option> <option value="believer" >Believer</option> <option value="scion" >Scion</option> <option value="worker" >Worker</option> <option value="student" >Student</option> <option value="witch" >Witch</option> </select> 
			<span> </span>
			
			<input name="attr_hard" class="sheet-stat-inputs hard" type="number" value="0" /> 
			<input name="attr_keen" class="sheet-stat-inputs keen" type="number" value="0" /> 
			<input name="attr_calm" class="sheet-stat-inputs calm" type="number" value="0" /> 
			<span> &nbsp; <input name="attr_daring" class="sheet-stat-inputs daring" type="number" value="0" /> </span>
			
			<input type="hidden" name="attr_wild" value="0">
			<input type="hidden" name="attr_playbook" class="sheet-playbook-name">
			<select name="attr_statpackage"  class="sheet-select-inputs sheet-statpackage"> <option value="devotee" class="playbook-fisher" selected>Devotee (2,-2,2,0)</option> <option value="wanderer" class="playbook-fisher" selected>Wanderer (-2,-1,4,1)</option> <option value="cryptic" class="playbook-fisher" selected>Cryptic (-1,2,3,-2)</option> <option value="shark" class="playbook-fisher" selected>Shark (3,-2,3,-2)</option>  <option value="wideeyed" class="playbook-witch" >Wide-Eyed (-1,-2,1,4,2[wild])</option> <option value="scholar" class="playbook-witch" >Scholar (-1,2,4,-3,2[wild])</option> <option value="avenger" class="playbook-witch" >Avenger (3,2,-2,-1,2[wild])</option> <option value="recluse" class="playbook-witch" >Recluse (-2,3,3,-2,2[wild])</option> <option value="bushpilot" class="playbook-farmer" >Bush Pilot (-1,2,-3,4)</option> <option value="huntsman" class="playbook-farmer" >Huntsman (3,-1,-2,2)</option>    <option value="escapist" class="playbook-farmer" >Escapist (-4,3,0,3)</option>     <option value="bumpkin" class="playbook-farmer" >Bumpkin (0,-3,3,2)</option>       <option value="blueblood" class="playbook-soldier" >Blueblood (2,-2,2,0)</option>  <option value="blowhard" class="playbook-soldier" >Blowhard (-3,4,-4,-3)</option>   <option value="recruit" class="playbook-soldier" >Recruit (1,1,0,0)</option>        <option value="professional" class="playbook-soldier" >Professional (3,0,1,-2)</option> <option value="singleminded" class="playbook-believer" >Single-Minded (3,0,-4,3)</option> <option value="intellectual" class="playbook-believer" >Intellectual (-2,3,3,-2)</option>                                                                          <option value="enforcer" class="playbook-believer" >Enforcer (3,-2,2,-1)</option>  <option value="dreamer" class="playbook-believer" >Dreamer (-3,1,2,2)</option>     <option value="wingwalker" class="playbook-skyborn" >Wingwalker (-2,-2,2,4)</option> <option value="trickster" class="playbook-skyborn" >Trickster (-3,3,-1,3)</option> <option value="defender" class="playbook-skyborn" >Defender (2,0,-2,2)</option>    <option value="trader" class="playbook-skyborn" >Trader (-1,-2,3,2)</option>       <option value="researcher" class="playbook-student" >Researcher (0,2,0,-1)</option>  <option value="inventor" class="playbook-student" >Inventor (-1,-2,2,2)</option>   <option value="tourist" class="playbook-student" >Tourist (1,1,-2,1)</option>      <option value="studybuddy" class="playbook-student" >Study Buddy (0,2,2,-3)</option>   <option value="feral" class="playbook-survivor" >Feral (3,3,-2,-2)</option>        <option value="wideeyed2" class="playbook-survivor" >Wide-Eyed (-4,3,2,1)</option>       <option value="recluse2" class="playbook-survivor" >Recluse (-2,3,3,-2)</option>         <option value="resigned" class="playbook-survivor" >Resigned (0,2,-2,2)</option>   <option value="fahnenjunker" class="playbook-scion" >Fahnenjunker (3,1,-2,0)</option>   <option value="highborn" class="playbook-scion" >Highborn (0,1,2,-1)</option>      <option value="dilettante" class="playbook-scion" >Dilettante (-1,2,2,-1)</option>      <option value="charlatan" class="playbook-scion" >Charlatan (-2,4,-2,2)</option>   <option value="jobber" class="playbook-worker" >Jobber (1,1,1,-1)</option>         <option value="worndown" class="playbook-worker" >Worn Down (2,2,2,-4)</option>          <option value="newleaseonlife" class="playbook-worker" >New Lease on Life (2,-1,-1,2)</option>                                                                          <option value="safetyinspector" class="playbook-worker" >Safety Inspector (-2,2,4,-2)</option>   </select>
			
			<!-- Age line -->	
			<label class="sheet-left-label">Age</label> <input name="attr_age" class="sheet-char-inputs" type="text"/>
			<span> </span>
			
			<label class="sheet-left-label">Pronouns</label> <input name="attr_Pronouns" class="sheet-char-inputs" type="text"/>
			<span> </span>
			
			<label class="sheet-left-label hard">Hard</label>
			<label class="sheet-left-label keen">Keen</label>
			<label class="sheet-left-label calm">Calm</label>
			<label class="sheet-left-label daring">Daring</label>
			
			<span> &nbsp; &nbsp; <input type="hidden" name="attr_hideresetstats" class="sheet-hide-stats-input" value="false" >
			<button type="action" name="act_hideresetstats_true" class="sheet-hide-stats-input sheet-stat-hide-button button-hide" > </button>
			<button type="action" name="act_hideresetstats_false" class="sheet-hide-stats-input sheet-stat-reveal-button button-reveal" > </button> &nbsp; &nbsp; &nbsp; &nbsp; <button type="action" name="act_resetstats" class="sheet-reset-stats" title="Select a starting stat package, click reset here, and then add +1 to any stat.">Reset </button> </span>
			
		</div>
		
		<!-- Spacing fix -->

		<div class="col" style="width: 100%; height: 4px;"></div>
		
		<!-- Hometown line -->	
		<div class='sheet-hometownline'>
			
			<label class="sheet-left-label">Hometown</label> <input name="attr_hometown" class="sheet-char-inputs" type="text"/>
			<span> </span>
			
			<label class="sheet-left-label">People</label> <input name="attr_people" class="sheet-char-inputs" type="text"/>
			<span> </span>
			
			<label class="sheet-left-label">Look</label> <input name="attr_look" class="sheet-char-inputs-long" type="text"/>
			<span> </span>

		</div>
		
		<!-- Adding some backgrounds to the circles -->	
		<div class='injuryboxesblackbacking'>
		
		</div>
		
		<!-- Plane line -->	
		<div class='sheet-planeline'>
			
			<label class="sheet-left-label">Plane</label> <input name="attr_plane" class="sheet-char-inputs" type="text"/>
			<span> </span>
			
			<label class="sheet-left-label">Injury</label> 
			
			<div class="injuryboxes">
			  <input checked="checked" class="radiobox reset" type="radio" name="attr_injury" value="0">
			  <input class="radiobox" type="radio" name="attr_injury" value="1">
			  <input class="radiobox" type="radio" name="attr_injury" value="2">
			  <input class="radiobox" type="radio" name="attr_injury" value="3">
			  <input class="radiobox" type="radio" name="attr_injury" value="4">
			  <input class="radiobox" type="radio" name="attr_injury" value="5">
			</div>
			
			<span> </span>
			
			<label class="sheet-left-label">Vice</label> 
			
			<div class="viceboxes">
			  <input checked="checked" class="radiobox reset" type="radio" name="attr_vice" value="0">
			  <input class="radiobox" type="radio" name="attr_vice" value="1">
			  <input class="radiobox" type="radio" name="attr_vice" value="2">
			  <input class="radiobox" type="radio" name="attr_vice" value="3">
			  <input class="radiobox" type="radio" name="attr_vice" value="4">
			  <input class="radiobox" type="radio" name="attr_vice" value="5">
			</div>
			
			<span> </span>
			
			<label class="sheet-left-label">XP</label> 
			<input name="attr_xp" class="sheet-stat-inputs" type="number" value="0" /> 

		</div>
		
		<!-- Spacing fix -->

		<div class="col" style="width: 100%; height: 4px;"></div>
		
		<!-- Adding some backgrounds to the circles -->	
		<div class='stressboxesblackbacking'>
		
		</div>
		<div class='stressboxestenbacking'>
		
		</div>
		
		<!-- Stress line -->	
		<div class='sheet-stressline'>
			
			<label class="sheet-left-label">Mastery</label> 
			
			<div class="masteryboxes">
			  <input checked="checked" class="radiobox reset" type="radio" name="attr_masteryprogress" value="0">
			  <input class="radiobox" type="radio" name="attr_masteryprogress" value="1">
			  <input class="radiobox" type="radio" name="attr_masteryprogress" value="2">
			  <input class="radiobox" type="radio" name="attr_masteryprogress" value="3">
			  <input class="radiobox" type="radio" name="attr_masteryprogress" value="4">
			  <input class="radiobox" type="radio" name="attr_masteryprogress" value="5">
			</div>
			
			<span> </span>
			
			<label class="sheet-left-label">Stress</label> 
			
			<div class="stressboxes">
			  <input checked="checked" class="radiobox reset" type="radio" name="attr_stress" value="0">
			  <input class="radiobox" type="radio" name="attr_stress" value="1">
			  <input class="radiobox" type="radio" name="attr_stress" value="2">
			  <input class="radiobox" type="radio" name="attr_stress" value="3">
			  <input class="radiobox" type="radio" name="attr_stress" value="4">
			  <input class="radiobox" type="radio" name="attr_stress" value="5">
			  <input class="radiobox" type="radio" name="attr_stress" value="6">
			  <input class="radiobox" type="radio" name="attr_stress" value="7">
			  <input class="radiobox" type="radio" name="attr_stress" value="8">
			  <input class="radiobox" type="radio" name="attr_stress" value="9">
			  <input class="radiobox" type="radio" name="attr_stress" value="10">
			</div>
			

		</div>
		
		<!-- Spacing fix -->

		<div class="col" style="width: 679px; height: 4px;"></div>
		
		<!-- Pilot Moves Column - different versions depending on advantage status -->	
		<div class='sheet-pilotmoves'>
			
			<!-- repeated here for hiding to work -->
			<input type="hidden" class="sheet-radio-roll-state" name="attr_rollstate" value="flat" />
			
			<h2 class="sheet-middle-title" > On Foot Moves </h2>
			
			<button type='action' name='act_advexplorethewild' class="sheet-rollbutton daring advantage" title="When you lead the group forward into the wild">Explore the Wild</button>
			<button type="roll" name="roll_explorethewild" value='&{template:com} {{char=@{character_name}}} {{move=Explore the Wild}} {{showroll=[[1]]}} {{statused=Daring}} {{check=[[2d10 + @{daring} + @{roll_mod} - @{injury}}]]}} {{success=@{explorethewildsuccess}}} {{partial=@{explorethewildpartial}}} {{miss=@{genericmiss}}}' class="sheet-rollbutton daring flat" title="When you lead the group forward into the wild" > Explore the Wild </button>
			<button type='action' name='act_disexplorethewild' class="sheet-rollbutton daring disadvantage" title="When you lead the group forward into the wild">Explore the Wild</button>

			<button type='action' name='act_advconfrontyourfears' class="sheet-rollbutton advantage" title="When you stand against that which stalks you, state what you fear it is">Confront Your Fears</button>
			<button type="roll" name="roll_confrontyourfears" value='&{template:com} {{char=@{character_name}}} {{move=Confront Your Fears}} {{showroll=[[1]]}} {{check=[[2d10  + @{roll_mod}}]]}} {{success=@{confrontyourfearssuccess}}} {{partial=@{confrontyourfearspartial}}} {{miss=@{confrontyourfearsmiss}}}' class="sheet-rollbutton flat" title="When you stand against that which stalks you, state what you fear it is" > Confront Your Fears </button>
			<button type='action' name='act_disconfrontyourfears' class="sheet-rollbutton disadvantage" title="When you stand against that which stalks you, state what you fear it is">Confront Your Fears</button>
			
			<button type='action' name='act_adv20parlaywiththestrange' class="sheet-rollbutton advantage" title="When you try to strike a deal with supernatural forces, state what you want and name two things you’d be willing to do or lose in exchange. If the offers are worthy, roll">Parlay with the Strange</button>
			<button type="roll" name="roll_parlaywiththestrange" value='&{template:com20} {{char=@{character_name}}} {{move=Parlay with the Strange}} {{showroll=[[1]]}} {{check=[[2d10  + @{roll_mod}}]]}} {{best=@{parlaywiththestrangebest}}} {{success=@{parlaywiththestrangesuccess}}} {{partial=@{parlaywiththestrangepartial}}} {{miss=@{parlaywiththestrangemiss}}}' class="sheet-rollbutton flat" title="When you try to strike a deal with supernatural forces, state what you want and name two things you’d be willing to do or lose in exchange. If the offers are worthy, roll" > Parlay with the Strange </button>
			<button type='action' name='act_dis20parlaywiththestrange' class="sheet-rollbutton disadvantage" title="When you try to strike a deal with supernatural forces, state what you want and name two things you’d be willing to do or lose in exchange. If the offers are worthy, roll">Parlay with the Strange</button>
			
			<button type='action' name='act_adv20seizetheinitiative' class="sheet-rollbutton advantage daring" title="When you encounter the enemy on foot, take 1 Stress and roll. If you are ambushing or defending a prepared position, take Advantage.">Seize the Initiative</button>
			<button type="roll" name="roll_seizetheinitiative" value='&{template:com20} {{char=@{character_name}}} {{move=Seize the Initiative}} {{showroll=[[1]]}} {{check=[[2d10 + @{daring}  + @{roll_mod} - @{injury}}]]}} {{best=@{seizetheinitiativebest}}} {{success=@{seizetheinitiativesuccess}}} {{partial=@{seizetheinitiativepartial}}} {{miss=@{seizetheinitiativemiss}}}' class="sheet-rollbutton flat daring" title="When you encounter the enemy on foot, take 1 Stress and roll. If you are ambushing or defending a prepared position, take Advantage." > Seize the Initiative </button>
			<button type='action' name='act_dis20seizetheinitiative' class="sheet-rollbutton disadvantage daring" title="When you encounter the enemy on foot, take 1 Stress and roll. If you are ambushing or defending a prepared position, take Advantage.">Seize the Initiative</button>
			
			<button type='action' name='act_advpersonalattackoffensive' class="sheet-rollbuttonlong advantage hard" title="When a PC attacks with a personal weapon">Personal Attack - Offensive</button>
			<button type='action' name='act_personalattackoffensive' class="sheet-rollbuttonlong flat hard" title="When a PC attacks with a personal weapon">Personal Attack - Offensive</button>
			<button type='action' name='act_dispersonalattackoffensive' class="sheet-rollbuttonlong disadvantage hard" title="When a PC attacks with a personal weapon">Personal Attack - Offensive</button>
			
			<span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <label class="sheet-big-label" > Hits </label> <input name="attr_hitspersonal" class="sheet-stat-inputs" type="number" value="0" /> </span>
			
			<button type='action' name='act_advpersonalattackdefensive' class="sheet-rollbuttonlong advantage keen" title="When a PC is attacked">Personal Attack - Defensive</button>
			<button type='action' name='act_personalattackdefensive' class="sheet-rollbuttonlong flat keen" title="When a PC is attacked">Personal Attack - Defensive</button>
			<button type='action' name='act_dispersonalattackdefensive' class="sheet-rollbuttonlong disadvantage keen" title="When a PC is attacked">Personal Attack - Defensive</button>
			
			<h2 class="sheet-middle-title" > Stress Release </h2>
			
			<button type="roll" name="roll_vent" value='&{template:comtext} {{char=@{character_name}}} {{move=Vent}} {{movedescription=@{vent}}}' class="sheet-rollbutton" title="When you are Burnt Out and use a Vent action" > Vent</button>
			
			<button type="roll" name="roll_indulgeinvicefamiliar" value='&{template:comtext} {{char=@{character_name}}} {{move=Indulge In Vice - Familiar}} {{movedescription=@{indulgeinvicefamiliar}}}' class="sheet-rollbuttonlong" title="When you indulge in a familiar Vice" > Indulge in Vice - Familiar</button>
			
			<button type='action' name='act_advindulgeinviceunfamiliar' class="sheet-rollbuttonlong daring advantage" title="When you engage in an unfamiliar Vice. If somebody familiar with an unfamiliar vice guides you, that’s Help.">Indulge in Vice - Unfamiliar</button>
			<button type="roll" name="roll_indulgeinviceunfamiliar" value='&{template:com} {{char=@{character_name}}} {{move=Indulge in Vice - Unfamiliar}} {{showroll=[[1]]}} {{statused=Daring}} {{check=[[2d10 + @{daring} + @{roll_mod} - @{injury}}]]}} {{success=@{indulgeinviceunfamiliarsuccess}}} {{infodesc=@{indulgeinviceunfamiliardesc}}} {{miss=@{indulgeinviceunfamiliarmiss}}}' class="sheet-rollbuttonlong daring flat" title="When you engage in an unfamiliar Vice. If somebody familiar with an unfamiliar vice guides you, that’s Help." > Indulge in Vice - Unfamiliar </button>
			<button type='action' name='act_disindulgeinviceunfamiliar' class="sheet-rollbuttonlong daring disadvantage" title="When you engage in an unfamiliar Vice. If somebody familiar with an unfamiliar vice guides you, that’s Help.">Indulge in Vice - Unfamiliar</button>
			
			<button type='action' name='act_endofnight' class="sheet-rollbutton" title="When you end the night, or hit 5 Vice">End of Night</button>
			
			<button type="roll" name="roll_qualitytime" value='&{template:comtext} {{char=@{character_name}}} {{move=Quality Time}} {{movedescription=@{qualitytime}}}' class="sheet-rollbutton" title="When you devote time and attention to your trusting Confidant" > Quality Time</button>
			
			
			<h2 class="sheet-middle-title" > Other Ground Moves </h2>
			
			<button type='action' name='act_advpresstheissue' class="sheet-rollbutton advantage" title="When you try to get somebody to do what you want and have leverage">Press the Issue</button>
			<button type="roll" name="roll_presstheissue" value='&{template:com} {{char=@{character_name}}} {{move=Press the Issue}} {{showroll=[[1]]}} {{check=[[2d10 + ?{When you try to get somebody to do what you want…|with Money pay their price and they’ll do it - no roll,0|with intimidation or force roll +Hard,@{hard}|with honest reasoning roll +Calm,@{calm}|with lies or misdirection roll +Keen,@{keen}} + @{roll_mod} - @{injury}}]]}} {{success=@{presstheissuesuccess}}} {{partial=@{presstheissuepartial}}} {{miss=@{genericmiss}}}' class="sheet-rollbutton flat" title="When you try to get somebody to do what you want and have leverage" > Press the Issue </button>
			<button type='action' name='act_dispresstheissue' class="sheet-rollbutton disadvantage" title="When you try to get somebody to do what you want and have leverage">Press the Issue</button>
			
			<button type='action' name='act_advturnonthecharm' class="sheet-rollbutton daring advantage" title="When you entice an interested party, roll. If they aren’t inclined to be interested, the move has no effect.">Turn on the Charm</button>
			<button type="roll" name="roll_turnonthecharm" value='&{template:com} {{char=@{character_name}}} {{move=Turn on the Charm}} {{showroll=[[1]]}} {{statused=Daring}} {{check=[[2d10 + @{daring} + @{roll_mod} - @{injury}}]]}} {{success=@{turnonthecharmsuccess}}} {{partial=@{turnonthecharmpartial}}} {{miss=@{genericmiss}}}' class="sheet-rollbutton daring flat" title="When you entice an interested party, roll. If they aren’t inclined to be interested, the move has no effect." > Turn on the Charm </button>
			<button type='action' name='act_disturnonthecharm' class="sheet-rollbutton daring disadvantage" title="When you entice an interested party, roll. If they aren’t inclined to be interested, the move has no effect.">Turn on the Charm</button>
			
			<button type='action' name='act_advgetreal' class="sheet-rollbutton advantage calm" title="When you speak the truth from your heart, and they are willing to listen">Get Real</button>
			<button type="roll" name="roll_getreal" value='&{template:com} {{char=@{character_name}}} {{move=Get Real}} {{showroll=[[1]]}} {{statused=Calm}} {{check=[[2d10 + @{calm} + @{roll_mod} - @{injury}}]]}} {{success=@{getrealsuccess}}} {{partial=@{getrealpartial}}} {{miss=@{getrealmiss}}} {{infodesc=?{When you speak the truth from your heart and they are willing to listen choose a goal from below and take 1 Stress.|Take them as a Confidant repair a relationship.|Begin a Move Exchange.|Remove 3 Stress between the two of you however you choose.|Offer them a chance to Rethink their Life (p.123). You choose the stats that change and if they accept they don’t spend any XP.}}}' class="sheet-rollbutton flat calm" title="When you try to get somebody to do what you want and have leverage" > Get Real </button>
			<button type='action' name='act_disgetreal' class="sheet-rollbutton disadvantage calm" title="When you speak the truth from your heart, and they are willing to listen">Get Real</button>
			
			<button type='action' name='act_advbrawl' class="sheet-rollbutton advantage hard" title="When you start something, verbal or physical (not intentionally lethal)">Brawl</button>
			<button type="roll" name="roll_brawl" value='&{template:com} {{char=@{character_name}}} {{move=Brawl}} {{showroll=[[1]]}} {{statused=Hard}} {{check=[[2d10 +@{hard} + @{roll_mod} - @{injury}}]]}} {{success=@{brawlsuccess}}} {{partial=@{brawlpartial}}} {{miss=@{brawlmiss}}}' class="sheet-rollbutton flat hard" title="When you start something, verbal or physical (not intentionally lethal)" > Brawl </button>
			<button type='action' name='act_disbrawl' class="sheet-rollbutton disadvantage hard" title="When you start something, verbal or physical (not intentionally lethal)">Brawl</button>
			
			
			<h2 class="sheet-middle-title" > Universal Moves </h2>
			
			<button type="roll" name="roll_breaktrust" value='&{template:comtext} {{char=@{character_name}}} {{move=Break Trust}} {{movedescription=@{breaktrust}}}' class="sheet-rollbutton" title="When you lose trust in a comrade" > Break Trust</button>
			
			<button type="roll" name="roll_restoretrust" value='&{template:comtext} {{char=@{character_name}}} {{move=Restore Trust}} {{movedescription=@{restoretrust}}}' class="sheet-rollbutton" title="When you show faith in a comrade" > Restore Trust</button>
			
			<button type="roll" name="roll_helphinder" value='&{template:comtext} {{char=@{character_name}}} {{move=Help/Hinder}} {{movedescription=@{helphinder}}}' class="sheet-rollbutton" title="When you help/hinder a comrade" > Help/Hinder</button>
			
			<button type="roll" name="roll_discoverbeauty" value='&{template:comtext} {{char=@{character_name}}} {{move=Discover Beauty}} {{movedescription=@{discoverbeauty}}}' class="sheet-rollbutton" title="Once per routine, when you witness beauty in the world" > Discover Beauty</button>
			
			<h2 class="sheet-middle-title" >  </h2>
			
		</div>
		
		<!-- Comrades and Vices section -->	
		<div class='sheet-comradesvices'>
			
			<h2 class="sheet-middle-title" > Comrades </h2> <h2 class="sheet-middle-title" > Trust? </h2> <span> </span> <h2 class="sheet-middle-title" > Familiar Vices </h2>
			
			<input name="attr_comrade1" class="sheet-char-inputs-medium" type="text"/> <input name="attr_comradetrust1" class="sheet-trust-boxes" type="checkbox"/> <span> </span> <input name="attr_familiarvice1" class="sheet-char-inputs-medium" type="text"/> 
			
			<input name="attr_comrade2" class="sheet-char-inputs-medium" type="text"/> <input name="attr_comradetrust2" class="sheet-trust-boxes" type="checkbox"/> <span> </span> <input name="attr_familiarvice2" class="sheet-char-inputs-medium" type="text"/> 
			
			<input name="attr_comrade3" class="sheet-char-inputs-medium" type="text"/> <input name="attr_comradetrust3" class="sheet-trust-boxes" type="checkbox"/> <span> </span> <input name="attr_familiarvice3" class="sheet-char-inputs-medium" type="text"/> 
			
			<input name="attr_comrade4" class="sheet-char-inputs-medium" type="text"/> <input name="attr_comradetrust4" class="sheet-trust-boxes" type="checkbox"/> <span> </span> <input name="attr_familiarvice4" class="sheet-char-inputs-medium" type="text"/> 
			
			<input name="attr_comrade5" class="sheet-char-inputs-medium" type="text"/> <input name="attr_comradetrust5" class="sheet-trust-boxes" type="checkbox"/> <span> </span> <input name="attr_familiarvice5" class="sheet-char-inputs-medium" type="text"/> 
			
			<input name="attr_comrade6" class="sheet-char-inputs-medium" type="text"/> <input name="attr_comradetrust6" class="sheet-trust-boxes" type="checkbox"/> <span> </span> <input name="attr_familiarvice6" class="sheet-char-inputs-medium" type="text"/> 

		</div>
		
		<!-- Spacing fix -->

		<div class="col" style="width: 679px; height: 8px;"></div>
		
		<!-- Playbook Specific section - everything that only belongs to one playbook -->	
		<div class='sheet-playbookspecific'>
			
			<input type="hidden" class="sheet-playsheettoggle" name="attr_playbook" />
			
			<!-- Fisher -->
			<div class='sheet-fisher'>
			
				<!-- Triggers & Vents -->
				<div class='sheet-triggersvents'>
					
					<h2 class="sheet-middle-title" > Triggers </h2> <h2 class="sheet-middle-title" > Stress </h2> <span> </span> <h2 class="sheet-middle-title" > Vents </h2>
			
					<label class="sheet-left-label-small">If you took a life</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Perform an act of faith in a public place</label>
					
					<label class="sheet-left-label-small">If you saw a corpse</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"> &nbsp; &nbsp; which will disturb those who see it.</label>
					
					<label class="sheet-left-label-small">... or worse, a shade</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Express displeasure in your comrades.</label>
					
					<label class="sheet-left-label-small">If you fight a great beast</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Sacrifice something of value.</label>
					
					<label class="sheet-left-label-small">If you call out to your Patrons</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Find a quiet place, regardless of danger.</label>
					
					<label class="sheet-left-label-small">... and your faith was tested</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Put yourself in danger as a test of faith.</label>
					
					<label class="sheet-left-label-small">If you or a comrade were hurt</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"></label>
					
					<label class="sheet-left-label-small">If you flew over open water</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"></label>
					
				</div>
				
				<div class="col" style="width: 679px; height: 8px;"></div>
				
				<!-- Intimacy Move -->
				<div class='sheet-intimacymove'>
					
					<h2 class="sheet-left-title" > Intimacy Move </h2>
					<label class="sheet-left-label-small"><b>Suggestion:</b> <i>When you spend your time close with another,</i> if you Trust one another, one person can lead the others in a trance, highlighting a stat for all of them. The entranced characters take +2 to that stat, and -1 to another of their choice, until the leader ends it with a word or signal. <p></p> <i>When you use this move in the air,</i> choose 1: ignore the penalty, take a +3 instead of a +2, take +2 to two stats.</label> 
					
				</div>
				
			</div>
			
			<!-- Witch -->
			<div class='sheet-witch'>
			
				<!-- Triggers & Vents -->
				<div class='sheet-triggersvents'>
					
					<h2 class="sheet-middle-title" > Triggers </h2> <h2 class="sheet-middle-title" > Stress </h2> <span> </span> <h2 class="sheet-middle-title" > Vents </h2>
			
					<label class="sheet-left-label-small">If you used magic violently</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Lose one of your Bonds.</label>
					
					<label class="sheet-left-label-small">If you failed your mission</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"> Wander out into the Wild.</label>
					
					<label class="sheet-left-label-small">If you missed a spell</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Hex somebody who has it coming.</label>
					
					<label class="sheet-left-label-small">If you faced down the fae</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Use yourself as a focus.</label>
					
					<label class="sheet-left-label-small">... and you lost</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Make an unwise pact with the fae.</label>
					
					<label class="sheet-left-label-small">If a comrade crashed</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Break a piece of needed technology.</label>
					
					<label class="sheet-left-label-small">If you were injured..</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Call somebody out. Make it hurt.</label>
					
					<label class="sheet-left-label-small">...if you passed out</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"></label>
					
				</div>
				
				<div class="col" style="width: 679px; height: 8px;"></div>
				
				<!-- Intimacy Move -->
				<div class='sheet-intimacymove'>
					
					<h2 class="sheet-left-title" > Intimacy Move </h2>
					<label class="sheet-left-label-small"><b>Of Blood:</b> <i>When you share an intimate moment with someone,</i> gain a bond of Blood with them, in addition to the bond you may already have. If you already have a bond, take +3 forward to use them as a Focus or target. <p></p> <i>If you use this move in the air,</i> the next time you use them as a Focus they are immune to the Injury they might take in the process.</label> 
					
				</div>
				
			</div>
			
			<!-- Farmer -->
			<div class='sheet-farmer'>
			
				<!-- Triggers & Vents -->
				<div class='sheet-triggersvents'>
					
					<h2 class="sheet-middle-title" > Triggers </h2> <h2 class="sheet-middle-title" > Stress </h2> <span> </span> <h2 class="sheet-middle-title" > Vents </h2>
			
					<label class="sheet-left-label-small">If you got hit by enemy fire</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Throw away or detach a weapon.</label>
					
					<label class="sheet-left-label-small">If you took a life</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small"> Whine and complain non-stop.</label>
					
					<label class="sheet-left-label-small">If a comrade was wounded</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Go flying alone and unwisely.</label>
					
					<label class="sheet-left-label-small">... and they didn’t make it</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Do something heroic and stupid.</label>
					
					<label class="sheet-left-label-small">If you caught fire</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Call somebody out. Make it hurt.</label>
					
					<label class="sheet-left-label-small">If you lost your plane</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small"></label>
					
					<label class="sheet-left-label-small">If innocents came to harm</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"></label>
					
					<label class="sheet-left-label-small">...and you couldn’t stop to help</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small"></label>
					
				</div>
				
				<div class="col" style="width: 679px; height: 8px;"></div>
				
				<!-- Intimacy Move -->
				<div class='sheet-intimacymove'>
					
					<h2 class="sheet-left-title" > Intimacy Move </h2>
					<label class="sheet-left-label-small"><b>I Will Be With You, Always:</b> <i>When you hold those you care for close,</i> they roll 4d10 and take the 2 highest when you Help them, ongoing as long as they Trust you. <p></p> If they’re an NPC, anything you do for them or help them with lets you roll 4d10 as well. <p></p> If you choose to Break Trust with one of these people, take 5 Stress. <p></p> If the Intimacy Move is used in the air, when you Help, you only take a hard move if both extra dice are 1s. A single 1 has no effect. <p></p> For this special advantage - use the flat die roller, manually roll the extra 2d10 and calculate the result - the advantage die roller will only do a single extra d10.</label> 
					
				</div>
				
			</div>
			
			<!-- Soldier -->
			<div class='sheet-soldier'>
			
				<!-- Triggers & Vents -->
				<div class='sheet-triggersvents'>
					
					<h2 class="sheet-middle-title" > Triggers </h2> <h2 class="sheet-middle-title" > Stress </h2> <span> </span> <h2 class="sheet-middle-title" > Vents </h2>
			
					<label class="sheet-left-label-small">If you fought non-humans</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Pick a fight with authority.</label>
					
					<label class="sheet-left-label-small">If you were hit by enemy fire</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"> Pick a fight with a comrade.</label>
					
					<label class="sheet-left-label-small">If you missed a full volley</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Get a comrade to break Trust with you.</label>
					
					<label class="sheet-left-label-small">If you were wounded</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Draw a weapon at a bad time.</label>
					
					<label class="sheet-left-label-small">If a comrade was wounded</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Hurt yourself to avoid going back up.</label>
					
					<label class="sheet-left-label-small">If you ran out of ammunition</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Throw away an award, medal, or prize.</label>
					
					<label class="sheet-left-label-small">If a comrade was lost</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small"></label>
					
					<label class="sheet-left-label-small">If your plane caught fire</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"></label>
					
				</div>
				
				<div class="col" style="width: 679px; height: 8px;"></div>
				
				<!-- Intimacy Move -->
				<div class='sheet-intimacymove'>
					
					<h2 class="sheet-left-title" > Intimacy Move </h2>
					<label class="sheet-left-label-small"><b>In Shining Armour:</b> <i>When you hold someone close to you,</i> hold 1. When they are in danger, spend that hold to arrive at their side. <p></p> <i>If you use this move in the air,</i> when you spend the hold, you next Move is an automatic full hit, no dice required.</label> 
					
				</div>
				
			</div>
			
			<!-- Believer -->
			<div class='sheet-believer'>
			
				<!-- Triggers & Vents -->
				<div class='sheet-triggersvents'>
					
					<h2 class="sheet-middle-title" > Triggers </h2> <h2 class="sheet-middle-title" > Stress </h2> <span> </span> <h2 class="sheet-middle-title" > Vents </h2>
			
					<label class="sheet-left-label-small">If a comrade was harmed</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">When Burnt Out, you can only Vent by...</label>
					
					<label class="sheet-left-label-small">If you didn’t score a kill</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"> Acting against your Convictions, losing 1</label>
					
					<label class="sheet-left-label-small">... but a comrade did</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">&nbsp; &nbsp; Reflection and 1 Stress each time.</label>
					
					<label class="sheet-left-label-small">If the mission failed</label> <label class="sheet-middle-label-small">4</label> <span> </span> <label class="sheet-left-label-small">Changing a Conviction, clearing all Stress</label>
					
					<label class="sheet-left-label-small">If your engines cut out</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">&nbsp; &nbsp; and Reflection. Half of your Reflection</label>
					
					<label class="sheet-left-label-small">If you had to abandon a kill</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">&nbsp; &nbsp; is returned as XP.</label>
					
					<label class="sheet-left-label-small">If you were shot at</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">At 10 Reflection, making a Sacrifice. This</label>
					
					<label class="sheet-left-label-small">...but they missed completely</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">&nbsp; &nbsp; clears 3 Stress. </label>
					
				</div>
				
				<div class="col" style="width: 679px; height: 8px;"></div>
				
				<!-- Intimacy Move -->
				<div class='sheet-intimacymove'>
					
					<h2 class="sheet-left-title" > Intimacy Move </h2>
					<label class="sheet-left-label-small"><b>Change for You:</b> <i>When you let others in,</i> allow them to give you a 3rd Conviction. They may instead choose to affirm a current belief: mark 3 on the Reflection track. At the end of the routine, remove 1 of your Convictions so you only have 2. <p></p> <i>If you use this move in the air,</i> if your partners give you a new Conviction, they may choose to gain Idealist, with the belief they gave you as their Conviction. Non-Believers always count as having a full Reflection track. If they choose to mark Reflection instead, mark 5.</label> 
					
				</div>
				
			</div>
			
			<!-- Skyborn -->
			<div class='sheet-skyborn'>
			
				<!-- Triggers & Vents -->
				<div class='sheet-triggersvents'>
					
					<h2 class="sheet-middle-title" > Triggers </h2> <h2 class="sheet-middle-title" > Stress </h2> <span> </span> <h2 class="sheet-middle-title" > Vents </h2>
			
					<label class="sheet-left-label-small">If your plane lost control</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Call somebody out. Make it hurt.</label>
					
					<label class="sheet-left-label-small">If you fought humans</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"> Pick a fight with a local.</label>
					
					<label class="sheet-left-label-small">... other Skyborn, even</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Pointlessly put yourself in danger.</label>
					
					<label class="sheet-left-label-small">If you were forced to land</label> <label class="sheet-middle-label-small">3</label> <span> </span> <label class="sheet-left-label-small">Deliberate, egregiously, and hilariously</label>
					
					<label class="sheet-left-label-small">If you failed the mission</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">&nbsp; &nbsp; violate local customs. </label>
					
					<label class="sheet-left-label-small">If the plane caught fire</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Get your stuff packed and move on to</label>
					
					<label class="sheet-left-label-small">If the fuel ran dry</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">&nbsp; &nbsp; the next town, right now. </label>
					
				</div>
				
				<div class="col" style="width: 679px; height: 8px;"></div>
				
				<!-- Intimacy Move -->
				<div class='sheet-intimacymove'>
					
					<h2 class="sheet-left-title" > Intimacy Move </h2>
					<label class="sheet-left-label-small"><b>Aloft:</b> <i>When you get intimate with somebody on the ground,</i> they can teach you a move as per a Move Exchange. <p></p> <i>If you use this move in the air,</i> you can instead teach them a move in the same way, and it costs only 2 XP.</label> 
					
				</div>
				
			</div>
			
			<!-- Student -->
			<div class='sheet-student'>
			
				<!-- Triggers & Vents -->
				<div class='sheet-triggersvents'>
					
					<h2 class="sheet-middle-title" > Triggers </h2> <h2 class="sheet-middle-title" > Stress </h2> <span> </span> <h2 class="sheet-middle-title" > Vents </h2>
			
					<label class="sheet-left-label-small">If you fought at all</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Tear up work (remove 1 Progress mark)</label>
					
					<label class="sheet-left-label-small">If you were wrong</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"> Make decisions for the team.</label>
					
					<label class="sheet-left-label-small">... and it got someone hurt</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Spend money you don’t have.</label>
					
					<label class="sheet-left-label-small">If your plane lost a vital part</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Lock yourself in to your work.</label>
					
					<label class="sheet-left-label-small">If there was a fire</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Deride the intelligence of others.</label>
					
					<label class="sheet-left-label-small">If you were injured</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Steal or plagiarize work.</label>
					
					<label class="sheet-left-label-small">If your ego was injured</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Make a roll without a skill you could</label>
					
					<label class="sheet-left-label-small">If you didn’t learn anything</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">&nbsp; &nbsp; have used. </label>
					
				</div>
				
				<div class="col" style="width: 679px; height: 8px;"></div>
				
				<!-- Intimacy Move -->
				<div class='sheet-intimacymove'>
					
					<h2 class="sheet-left-title" > Intimacy Move </h2>
					<label class="sheet-left-label-small"><b>Curiosity:</b> <i>When you put aside your work for somebody,</i> each of you asks another a personal question. You do not need to answer, or answer honestly, but each question answered honestly gives everyone 1 XP. Nobody can be asked more than one question. <p></p> <i>If you use this move in the air,</i> anyone who is honest gets +1 XP.</label> 
					
				</div>
				
			</div>
			
			<!-- Survivor -->
			<div class='sheet-survivor'>
			
				<!-- Triggers & Vents -->
				<div class='sheet-triggersvents'>
					
					<h2 class="sheet-middle-title" > Triggers </h2> <h2 class="sheet-middle-title" > Stress </h2> <span> </span> <h2 class="sheet-middle-title" > Vents </h2>
			
					<label class="sheet-left-label-small">If you fought at all</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Ruin a social gathering.</label>
					
					<label class="sheet-left-label-small">If you braved poison gas</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"> Hide yourself away somewhere.</label>
					
					<label class="sheet-left-label-small">If your engine stopped</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Steal something.</label>
					
					<label class="sheet-left-label-small">If a friend was hurt</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Stockpile something useless.</label>
					
					<label class="sheet-left-label-small">... if they died</label> <label class="sheet-middle-label-small">3</label> <span> </span> <label class="sheet-left-label-small">Run away to somewhere unsafe.</label>
					
					<label class="sheet-left-label-small">If you ran out of fuel or ammo</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Find the high ground and stay there.</label>
					
					<label class="sheet-left-label-small">If you couldn’t escape</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"></label>
					
					<label class="sheet-left-label-small">If you had to socialize</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small"></label>
					
				</div>
				
				<div class="col" style="width: 679px; height: 8px;"></div>
				
				<!-- Intimacy Move -->
				<div class='sheet-intimacymove'>
					
					<h2 class="sheet-left-title" > Intimacy Move </h2>
					<label class="sheet-left-label-small"><b>Together:</b> <i>When you try to be intimate with others...</i> <ul> <li> If you only have Masked, it doesn’t happen. </li> <li> If you have Comfort Object, gain 1 Progress. </li> <li> If you’ve crossed both out, the participants all tell a secret about themselves and hold 1. These holds can be spent to reroll a move. </li>  </ul> <p></p> <i>If you use the final move in the air,</i> everyone gains 2 holds.</label> 
					
				</div>
				
			</div>
			
			<!-- Scion -->
			<div class='sheet-scion'>
			
				<!-- Triggers & Vents -->
				<div class='sheet-triggersvents'>
					
					<h2 class="sheet-middle-title" > Triggers </h2> <h2 class="sheet-middle-title" > Stress </h2> <span> </span> <h2 class="sheet-middle-title" > Vents </h2>
			
					<label class="sheet-left-label-small">If you were wounded</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Take money from your estate for</label>
					
					<label class="sheet-left-label-small">If you were disobeyed</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"> &nbsp; &nbsp; something frivolous.</label>
					
					<label class="sheet-left-label-small">... but everything worked out</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Insult the heritage of a comrade.</label>
					
					<label class="sheet-left-label-small">If your plane was damaged</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Claim something that isn’t yours.</label>
					
					<label class="sheet-left-label-small">If you had to fight family</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Challenge somebody to a duel.</label>
					
					<label class="sheet-left-label-small"></label> <label class="sheet-middle-label-small"></label> <span> </span> <label class="sheet-left-label-small">Blame somebody else for your failures.</label>
					
					<label class="sheet-left-label-small"></label> <label class="sheet-middle-label-small"></label> <span> </span> <label class="sheet-left-label-small">Go to the law with a complaint.</label>
					
					
				</div>
				
				<div class="col" style="width: 679px; height: 8px;"></div>
				
				<!-- Intimacy Move -->
				<div class='sheet-intimacymove'>
					
					<h2 class="sheet-left-title" > Intimacy Move </h2>
					<label class="sheet-left-label-small"><b>Entrusted:</b> <i>When you hold those you care for close,</i> figure out among your partners who takes charge. If it’s you, add +1 to a Stat for the next routine. If it’s one of them, clear 2 Stress immediately. <p></p> <i>If you use this move in the air,</i> all PCs involved get both +1 to a Stat and clear 2 Stress, though you should still figure it out.</label> 
					
				</div>
				
			</div>
			
			<!-- Worker -->
			<div class='sheet-worker'>
			
				<!-- Triggers & Vents -->
				<div class='sheet-triggersvents'>
					
					<h2 class="sheet-middle-title" > Triggers </h2> <h2 class="sheet-middle-title" > Stress </h2> <span> </span> <h2 class="sheet-middle-title" > Vents </h2>
			
					<label class="sheet-left-label-small">If you took a life</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Complain about your circumstances to a</label>
					
					<label class="sheet-left-label-small">If there was combat</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"> &nbsp; &nbsp; comrade.</label>
					
					<label class="sheet-left-label-small">If your plane got shot</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small">Buy something nice for yourself.</label>
					
					<label class="sheet-left-label-small">If you were wounded</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Complain about pay to a comrade.</label>
					
					<label class="sheet-left-label-small">If a comrade was wounded</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Stir up trouble with the employees.</label>
					
					<label class="sheet-left-label-small">If your plane stopped working</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small">Deliberately trigger End of Night by</label>
					
					<label class="sheet-left-label-small">If you had to wingwalk</label> <label class="sheet-middle-label-small">1</label> <span> </span> <label class="sheet-left-label-small"> &nbsp; &nbsp; maxing out your Vice track.</label>
					
					<label class="sheet-left-label-small">If the job got out of hand</label> <label class="sheet-middle-label-small">2</label> <span> </span> <label class="sheet-left-label-small"></label>
					
				</div>
				
				<div class="col" style="width: 679px; height: 8px;"></div>
				
				<!-- Intimacy Move -->
				<div class='sheet-intimacymove'>
					
					<h2 class="sheet-left-title" > Intimacy Move </h2>
					<label class="sheet-left-label-small"><b>Share the Burden:</b> <i>When you are intimate with comrades,</i> the Stress of all the characters participating can be freely redistributed between them. If there are any NPC participants, 1 Stress is also removed from each PC. <p></p> <i>If you use this move in the air,</i> 1 additional Stress is removed from each character.</label> 
					
				</div>
				
			</div>
			
		</div>
		
		
		<!-- Personal Moves section -->	
		
		
		<!-- Master Moves section -->	
		<div class='sheet-masterymoves'>
			
			<div class="col" style="width: 679px; height: 8px;"></div>
			
			<!-- Bushwack Mastery -->
			<span> <input type="hidden" name="attr_hidebushwackmastery" class="sheet-hide-bushwack-input" value="false" >
			<button type="action" name="act_hidebushwackmastery_true" class="sheet-hide-bushwack-input sheet-bushwack-hide-button button-hide" > </button>
			<button type="action" name="act_hidebushwackmastery_false" class="sheet-hide-bushwack-input sheet-bushwack-reveal-button button-reveal" > </button> 
			&nbsp; &nbsp; <h2 class="sheet-left-title" > Bushwack Mastery </h2>  &nbsp; &nbsp;
			
			<input type="hidden" name="attr_hidebushwackmasteryunchecked" class="sheet-hide-bushwackunchecked-input" value="false" >
			<button type="action" name="act_hidebushwackmasteryunchecked_true" class="sheet-hide-bushwackunchecked-input sheet-bushwackunchecked-hide-button button-hide" > </button>
			<button type="action" name="act_hidebushwackmasteryunchecked_false" class="sheet-hide-bushwackunchecked-input sheet-bushwackunchecked-reveal-button button-reveal" > </button> 
			
			<div class='sheet-bushwackmastery'> 
				
				<label class="sheet-left-label-small"><u>Victories:</u> <i> Aircraft or balloons shot down. </i></label> 
				
				<label class="sheet-left-label-small"><u>Passive:</u> <i> Each move taken past the first gives a flat +2 Damage at all ranges when you Open Fire. </i></label> 
				
				<div class="col" style="width: 679px; height: 4px;"></div>
				
				<input type="hidden" name="attr_hidebushwackmasteryunchecked" class="sheet-hide-bushwackunchecked-input" value="false" >
				
				<div class="bushwackunchecked"><input name="attr_bushwackmastery_1" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Ambush Predator:</b> <i>When you attack an aircraft which doesn’t know you are there,</i> inflict double damage.</label> </div>
				
				<div class="bushwackunchecked"><input name="attr_bushwackmastery_2" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Vanishing Act:</b> <i> When you attack an enemy from above, </i> take 1 RPM to make the enemy lose track of you afterward. This would allow Ambush Predator to be activated again.</label> </div>
				
				<div class="bushwackunchecked"><input name="attr_bushwackmastery_3" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Overdrive:</b> <i> When you Open Fire while travelling faster than your Max Speed, </i> shift your Effective Range one band closer.</label> </div>
				
				<div class="bushwackunchecked"><input name="attr_bushwackmastery_4" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Boom & Zoom:</b> Count your G-Force as one lower for pilot penalties, and reduce your Energy Loss by 1 (minimum 1).</label> </div>
				
				<div class="bushwackunchecked"><input name="attr_bushwackmastery_5" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Vulture:</b> <i> When you attack a target below half Structure, </i> activate Ambush Predator (even if you don’t have the move).</label> </div>
				
			</div>
			
			</span>
			
			<div class="col" style="width: 679px; height: 8px;"></div>
			
			<!-- Slipstream Mastery -->
			<span> <input type="hidden" name="attr_hideslipstreammastery" class="sheet-hide-slipstream-input" value="false" >
			<button type="action" name="act_hideslipstreammastery_true" class="sheet-hide-slipstream-input sheet-slipstream-hide-button button-hide" > </button>
			<button type="action" name="act_hideslipstreammastery_false" class="sheet-hide-slipstream-input sheet-slipstream-reveal-button button-reveal" > </button> 
			&nbsp; &nbsp; <h2 class="sheet-left-title" > Slipstream Mastery </h2>  &nbsp; &nbsp;
			
			<input type="hidden" name="attr_hideslipstreammasteryunchecked" class="sheet-hide-slipstreamunchecked-input" value="false" >
			<button type="action" name="act_hideslipstreammasteryunchecked_true" class="sheet-hide-slipstreamunchecked-input sheet-slipstreamunchecked-hide-button button-hide" > </button>
			<button type="action" name="act_hideslipstreammasteryunchecked_false" class="sheet-hide-slipstreamunchecked-input sheet-slipstreamunchecked-reveal-button button-reveal" > </button> 
			
			<div class='sheet-slipstreammastery'> 
				
				<label class="sheet-left-label-small"><u>Victories:</u> <i> Aircraft shot down, crashed, or lured to their destruction. </i></label> 
				
				<label class="sheet-left-label-small"><u>Passive:</u> <i> Each move taken past the first adds +2 Hits (for the purposes of Crits only) when you Open Fire. </i></label> 
				
				<div class="col" style="width: 679px; height: 4px;"></div>
				
				<input type="hidden" name="attr_hideslipstreammasteryunchecked" class="sheet-hide-slipstreamunchecked-input" value="false" >
				
				<div class="slipstreamunchecked"><input name="attr_slipstreammastery_1" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Tables Have Turned:</b> <i>If you are being chased or get behind your attacker,</i> the next person to attack your pursuer (including yourself) may use their best stat to Open Fire against them.</label> </div>
				
				<div class="slipstreamunchecked"><input name="attr_slipstreammastery_2" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Dangerous Merge:</b> <i> If you go head-on with a foe while trailing a pursuer, </i> <u> roll +Daring. </u> <input type="hidden" class="sheet-radio-roll-state" name="attr_rollstate" value="flat" /> <button type='action' name='act_advdangerousmerge' class="sheet-rollbuttond10 daring advantage" ></button>
				<button type="roll" name="roll_dangerousmerge" value='&{template:com} {{char=@{character_name}}} {{move=Dangerous Merge}} {{statused=Daring}} {{showroll=[[1]]}} {{check=[[2d10 + @{daring} + @{roll_mod} - @{injury}}]]}} {{success=@{dangerousmergesuccess}}} {{partial=@{dangerousmergepartial}}} {{miss=@{genericmiss}}}' class="sheet-rollbuttond10 daring flat" > </button>
				<button type='action' name='act_disdangerousmerge' class="sheet-rollbuttond10 daring disadvantage" ></button> </label> </div>
				
				<div class="slipstreamunchecked"><input name="attr_slipstreammastery_3" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Headache Spin:</b> <i> When you deliberately induce a spin while being chased, </i> roll to Recover as usual. Your enemy will believe you have been shot down, and you will take Advantage forward against them.</label> </div>
				
				<div class="slipstreamunchecked"><input name="attr_slipstreammastery_4" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Welcome to Earth:</b> <i> When you dive to ground level to escape a plane on your six, </i> on a 16+, your pursuer ploughs into the ground.</label> </div>
				
				<div class="slipstreamunchecked"><input name="attr_slipstreammastery_5" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Slippery Customer:</b> You may roll Dogfight to escape any aircraft attacking you before you Take Fire, even if you would normally just Take Fire, so long as you aren’t rolling two Dogfights in a row. </label> </div>
				
			</div>
			
			</span>
			
			<div class="col" style="width: 679px; height: 8px;"></div>
			
			<!-- Dogfighter Mastery -->
			<span> <input type="hidden" name="attr_hidedogfightermastery" class="sheet-hide-dogfighter-input" value="false" >
			<button type="action" name="act_hidedogfightermastery_true" class="sheet-hide-dogfighter-input sheet-dogfighter-hide-button button-hide" > </button>
			<button type="action" name="act_hidedogfightermastery_false" class="sheet-hide-dogfighter-input sheet-dogfighter-reveal-button button-reveal" > </button> 
			&nbsp; &nbsp; <h2 class="sheet-left-title" > Dogfighter Mastery </h2>  &nbsp; &nbsp;
			
			<input type="hidden" name="attr_hidedogfightermasteryunchecked" class="sheet-hide-dogfighterunchecked-input" value="false" >
			<button type="action" name="act_hidedogfightermasteryunchecked_true" class="sheet-hide-dogfighterunchecked-input sheet-dogfighterunchecked-hide-button button-hide" > </button>
			<button type="action" name="act_hidedogfightermasteryunchecked_false" class="sheet-hide-dogfighterunchecked-input sheet-dogfighterunchecked-reveal-button button-reveal" > </button> 
			
			<div class='sheet-dogfightermastery'> 
				
				<label class="sheet-left-label-small"><u>Victories:</u> <i> Aircraft shot down, pilots surrendered, or probable kills. </i></label> 
				
				<label class="sheet-left-label-small"><u>Passive:</u> <i> Each move taken past the first adds a flat +4 Damage when you Open Fire at an Absolute Range of Knife. </i></label> 
				
				<div class="col" style="width: 679px; height: 4px;"></div>
				
				<input type="hidden" name="attr_hidedogfightermasteryunchecked" class="sheet-hide-dogfighterunchecked-input" value="false" >
				
				<div class="dogfighterunchecked"><input name="attr_dogfightermastery_1" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Riding the Edge:</b> Your plane counts as having +5 Handling, and you lose 1 fewer Speed overall when you Commit to the Turn (minimum 0).</label> </div>
				
				<div class="dogfighterunchecked"><input name="attr_dogfightermastery_2" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Head to Head:</b> <i> When you would be shot at from behind, </i> you can spend Speed equal to Turn Bleed to instead transition directly into a knife-range head-on attack, and take +3 forward to Open Fire.</label> </div>
				
				<div class="dogfighterunchecked"><input name="attr_dogfightermastery_3" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Nerves of Steel:</b> <i> When you attack at an absolute range of Knife, </i> you can reroll your attack move if you don’t like the result. Second results stand.</label> </div>
				
				<div class="dogfighterunchecked"><input name="attr_dogfightermastery_4" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Belly Scrape:</b> <i> When you fly at ground level, </i> gain a +10 Handling and +1 to Evade Danger.</label> </div>
				
				<div class="dogfighterunchecked"><input name="attr_dogfightermastery_5" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Switch Weave:</b> <i> When you escort a formation, </i> you provide Overwatch to all members, not just one.</label> </div>
				
			</div>
			
			</span>
			
			<div class="col" style="width: 679px; height: 8px;"></div>
			
			<!-- Sharpshooter Mastery -->
			<span> <input type="hidden" name="attr_hidesharpshootermastery" class="sheet-hide-sharpshooter-input" value="false" >
			<button type="action" name="act_hidesharpshootermastery_true" class="sheet-hide-sharpshooter-input sheet-sharpshooter-hide-button button-hide" > </button>
			<button type="action" name="act_hidesharpshootermastery_false" class="sheet-hide-sharpshooter-input sheet-sharpshooter-reveal-button button-reveal" > </button> 
			&nbsp; &nbsp; <h2 class="sheet-left-title" > Sharpshooter Mastery </h2>  &nbsp; &nbsp;
			
			<input type="hidden" name="attr_hidesharpshootermasteryunchecked" class="sheet-hide-sharpshooterunchecked-input" value="false" >
			<button type="action" name="act_hidesharpshootermasteryunchecked_true" class="sheet-hide-sharpshooterunchecked-input sheet-sharpshooterunchecked-hide-button button-hide" > </button>
			<button type="action" name="act_hidesharpshootermasteryunchecked_false" class="sheet-hide-sharpshooterunchecked-input sheet-sharpshooterunchecked-reveal-button button-reveal" > </button> 
			
			<div class='sheet-sharpshootermastery'> 
				
				<label class="sheet-left-label-small"><u>Victories:</u> <i> Aircraft or balloons shot down, or probable kills. </i></label> 
				
				<label class="sheet-left-label-small"><u>Passive:</u> <i> Each move taken past the first adds a flat +4 Damage when you Open Fire at an Absolute Range of Long, and +2 Damage at an Absolute Range of Extreme, providing you hit at all. </i></label> 
				
				<div class="col" style="width: 679px; height: 4px;"></div>
				
				<input type="hidden" name="attr_hidesharpshootermasteryunchecked" class="sheet-hide-sharpshooterunchecked-input" value="false" >
				
				<div class="sharpshooterunchecked"><input name="attr_sharpshootermastery_1" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Metal or Meat:</b> <i>When you Draw a Bead,</i> the Open Fire +Calm result can be taken for free, in addition to other results you qualify for.</label> </div>
				
				<div class="sharpshooterunchecked"><input name="attr_sharpshootermastery_2" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Concentrated Shooting:</b> <i> When you Draw a Bead, </i> take +1 results.</label> </div>
				
				<div class="sharpshooterunchecked"><input name="attr_sharpshootermastery_3" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Tracer Dance:</b> <i> When you fire on an enemy during a chase, </i> spend 1 ammo. The enemy is forced to turn, and you immediately win the chase.</label> </div>
				
				<div class="sharpshooterunchecked"><input name="attr_sharpshootermastery_4" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Lead the Target:</b> Ignore the Deflection Shot penalty (but not Awkward).</label> </div>
				
				<div class="sharpshooterunchecked"><input name="attr_sharpshootermastery_5" class="sheet-used-boxes" type="checkbox"/> <label class="sheet-left-label-small"><b>Lucky Shot:</b> <i> When attacking at an absolute range of Long or Extreme, roll +1 Crit Die.</label> </div>
				
			</div>
			
			</span>
			
			
		</div>
		
		<div class="col" style="width: 679px; height: 8px;"></div>
		
		
		
		
		
		
		
	
	</div>
	
	
<!-- Plane tab start-->	
    <div class='tab-plane'>
        <div class='instrument-panel'>
            <img src="https://raw.githubusercontent.com/cbkcook/roll20-character-sheets/Flying-Circus/Flying%20Circus/fc%20panel%20fuel%20plus.jpg" alt="Flying Circus Dashboard" >
        </div>
        <!-- Altimeter-->
        <div class='alt meter token'>
            <label class='deg270'><input type="radio" name="attr_alt100" value="0" checked="checked"><span class="checkmark"></span></label>
            <label class='deg306'><input type="radio" name="attr_alt100" value="1"><span class="checkmark"></span></label>
            <label class='deg342'><input type="radio" name="attr_alt100" value="2"><span class="checkmark"></span></label>
            <label class='deg18'><input type="radio" name="attr_alt100" value="3"><span class="checkmark"></span></label>
            <label class='deg54'><input type="radio" name="attr_alt100" value="4"><span class="checkmark"></span></label>
            <label class='deg90'><input type="radio" name="attr_alt100" value="5"><span class="checkmark"></span></label>
            <label class='deg126'><input type="radio" name="attr_alt100" value="6"><span class="checkmark"></span></label>
            <label class='deg162'><input type="radio" name="attr_alt100" value="7"><span class="checkmark"></span></label>
            <label class='deg198'><input type="radio" name="attr_alt100" value="8"><span class="checkmark"></span></label>
            <label class='deg234'><input type="radio" name="attr_alt100" value="9"><span class="checkmark"></span></label>
        </div>
	
	    <div class='alt meter-inside token'>
            <label class='deg270-inside'><input type="radio" name="attr_alt1000" value="0" checked="checked"><span class="checkmark"></span></label>
            <label class='deg306-inside'><input type="radio" name="attr_alt1000" value="10"><span class="checkmark"></span></label>
            <label class='deg342-inside'><input type="radio" name="attr_alt1000" value="20"><span class="checkmark"></span></label>
            <label class='deg18-inside'><input type="radio" name="attr_alt1000" value="30"><span class="checkmark"></span></label>
            <label class='deg54-inside'><input type="radio" name="attr_alt1000" value="40"><span class="checkmark"></span></label>
            <label class='deg90-inside'><input type="radio" name="attr_alt1000" value="50"><span class="checkmark"></span></label>
            <label class='deg126-inside'><input type="radio" name="attr_alt1000" value="60"><span class="checkmark"></span></label>
            <label class='deg162-inside'><input type="radio" name="attr_alt1000" value="70"><span class="checkmark"></span></label>
            <label class='deg198-inside'><input type="radio" name="attr_alt1000" value="80"><span class="checkmark"></span></label>
            <label class='deg234-inside'><input type="radio" name="attr_alt1000" value="90"><span class="checkmark"></span></label>
        </div>
        
        <div class='alt' >
            <input name="attr_alt" class="alt-number" type="number" value="0" />
        </div>	
        <!-- Spedometer-->
        <div class='spd meter token'>
            <label class='deg270'><input type="radio" name="attr_spd10" value="0" checked="checked"><span class="checkmark"></span></label>
            <label class='deg306'><input type="radio" name="attr_spd10" value="1"><span class="checkmark"></span></label>
            <label class='deg342'><input type="radio" name="attr_spd10" value="2"><span class="checkmark"></span></label>
            <label class='deg18'><input type="radio" name="attr_spd10" value="3"><span class="checkmark"></span></label>
            <label class='deg54'><input type="radio" name="attr_spd10" value="4"><span class="checkmark"></span></label>
            <label class='deg90'><input type="radio" name="attr_spd10" value="5"><span class="checkmark"></span></label>
            <label class='deg126'><input type="radio" name="attr_spd10" value="6"><span class="checkmark"></span></label>
            <label class='deg162'><input type="radio" name="attr_spd10" value="7"><span class="checkmark"></span></label>
            <label class='deg198'><input type="radio" name="attr_spd10" value="8"><span class="checkmark"></span></label>
            <label class='deg234'><input type="radio" name="attr_spd10" value="9"><span class="checkmark"></span></label>
        </div>

        <div class='spd meter-inside token'>
            <label class='deg270-inside'><input type="radio" name="attr_spd100" value="0" checked="checked"><span class="checkmark"></span></label>
            <label class='deg306-inside'><input type="radio" name="attr_spd100" value="10"><span class="checkmark"></span></label>
            <label class='deg342-inside'><input type="radio" name="attr_spd100" value="20"><span class="checkmark"></span></label>
            <label class='deg18-inside'><input type="radio" name="attr_spd100" value="30"><span class="checkmark"></span></label>
            <label class='deg54-inside'><input type="radio" name="attr_spd100" value="40"><span class="checkmark"></span></label>
            <label class='deg90-inside'><input type="radio" name="attr_spd100" value="50"><span class="checkmark"></span></label>
            <label class='deg126-inside'><input type="radio" name="attr_spd100" value="60"><span class="checkmark"></span></label>
            <label class='deg162-inside'><input type="radio" name="attr_spd100" value="70"><span class="checkmark"></span></label>
            <label class='deg198-inside'><input type="radio" name="attr_spd100" value="80"><span class="checkmark"></span></label>
            <label class='deg234-inside'><input type="radio" name="attr_spd100" value="90"><span class="checkmark" ></span></label>
        </div>
        
        <div class='spd' >
            <input name="attr_spd" class="spd-number" type="number" value="0" />
        </div>
        <!-- Fuel -->
        <div class='fuel' >
            <input name="attr_fuel" class="plane-stat" type="text" value="0" />
            <input name="attr_fuel_max" class="plane-stat" type="text" value="0" />
        </div>
        <!-- Dry Stats -->
        <input name="attr_visibility" class="plane-stat visibility" type="text" value="0" />
        <input name="attr_stability" class="plane-stat stability" type="text" value="0" />
        <input name="attr_energy_loss" class="plane-stat energy-loss" type="text" value="0" />
        <input name="attr_turn_bleed" class="plane-stat turn-bleed" type="text" value="0" />
        <!-- Dry Stats -->
        <input name="attr_escape" class="plane-stat escape" type="text" value="0" />
        <input name="attr_crash" class="plane-stat crash" type="text" value="0" />
	    <!-- Currently Being Replaced, keeping for emergency
	    <div class='wear engine token'>
            <label class='deg0-e'><input type="radio" name="wear"><span class="checkmark"></span></label>
            <label class='deg45-e'><input type="radio" name="wear"><span class="checkmark"></span></label>
            <label class='deg90-e'><input type="radio" name="wear"><span class="checkmark"></span></label>
            <label class='deg135-e'><input type="radio" name="wear"><span class="checkmark"></span></label>
            <label class='deg180-e'><input type="radio" name="wear"><span class="checkmark"></span></label>
            <label class='deg225-e'><input type="radio" name="wear"><span class="checkmark"></span></label>
            <label class='deg270-e'><input type="radio" name="wear" checked="checked"><span class="checkmark"></span></label>
            <label class='deg315-e'><input type="radio" name="wear"><span class="checkmark"></span></label>
        </div>
	
	    <div class='rpm engine token'>
            <label class='deg0-e'><input type="radio" name="rpm"><span class="checkmark"></span></label>
            <label class='deg45-e'><input type="radio" name="rpm"><span class="checkmark"></span></label>
            <label class='deg90-e'><input type="radio" name="rpm"><span class="checkmark"></span></label>
            <label class='deg135-e'><input type="radio" name="rpm"><span class="checkmark"></span></label>
            <label class='deg180-e'><input type="radio" name="rpm"><span class="checkmark"></span></label>
            <label class='deg225-e'><input type="radio" name="rpm"><span class="checkmark"></span></label>
            <label class='deg270-e'><input type="radio" name="rpm" checked="checked"><span class="checkmark"></span></label>
            <label class='deg315-e'><input type="radio" name="rpm"><span class="checkmark"></span></label>
        </div>
        -->

    </div>
	
	
	
	
	
	
	
	
	
	
	
	
	
	<!-- Ground Move outcomes -->
	
	
	<!-- Explore the Wild possible outcomes -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result 16+ : </span>
			<textarea name="attr_explorethewildsuccess" class="sheet-actiondesc" placeholder="Great Success" title="Great Success">On a hit, overcome 1 Trek. 16+, choose 2:<!--
			--><ul><!--
				--><li>Move safely and quietly.</li><!--
				--><li>If something happens, you have Advantage to Engage.</li><!--
				--><li>Overcome another Trek.</li><!--
				--><li>Leave a trail, giving Advantage to backtrack.</li><!--
			--></ul><!--
			--></textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 11-15 : </span>
			<textarea name="attr_explorethewildpartial" class="sheet-actiondesc" placeholder="Mild Success" title="Mild Success">On a hit, overcome 1 Trek. On an 11-15, choose 1:<!--
			--><ul><!--
				--><li>Move safely and quietly.</li><!--
				--><li>If something happens, you have Advantage to Engage.</li><!--
				--><li>Overcome another Trek.</li><!--
				--><li>Leave a trail, giving Advantage to backtrack.</li><!--
			--></ul><!--
			--></textarea>
		</div>
		<!-- Generic failure listed here -->
		<div class="sheet-action">
			<span class="sheet-action">Result 10- : </span>
			<textarea name="attr_genericmiss" class="sheet-actiondesc" placeholder="Miss" title="Miss">On a miss, the GM throws a twist.
			</textarea>
		</div>
	</div>
	
	<!-- Confront Your Fears possible outcomes -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result 16+ : </span>
			<textarea name="attr_confrontyourfearssuccess" class="sheet-actiondesc" placeholder="Great Success" title="Great Success">On a 16+, the GM reveals how it is more innocuous than you suspected.
			</textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 11-15 : </span>
			<textarea name="attr_confrontyourfearspartial" class="sheet-actiondesc" placeholder="Mild Success" title="Mild Success">On an 11-15, the GM reveals how it is stranger than you suspected.
			</textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 10- : </span>
			<textarea name="attr_confrontyourfearsmiss" class="sheet-actiondesc" placeholder="Miss" title="Miss">On a miss, the GM reveals how it was far worse than you feared.
			</textarea>
		</div>
	</div>
	
	<!-- Parlay with the Strange possible outcomes -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result 20+ : </span>
			<textarea name="attr_parlaywiththestrangebest" class="sheet-actiondesc" placeholder="Best Success" title="Best Success">On a 20+, you get what you want and keep everything.
			</textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 16-19 : </span>
			<textarea name="attr_parlaywiththestrangesuccess" class="sheet-actiondesc" placeholder="Great Success" title="Great Success">On a 16+, they take one of your offers and give you what you want, no strings attached.
			</textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 11-15 : </span>
			<textarea name="attr_parlaywiththestrangepartial" class="sheet-actiondesc" placeholder="Mild Success" title="Mild Success">On an 11-15, they take one, and the GM chooses 1:<!--
			--><ul><!--
				--><li>They take the other offer too.</li><!--
				--><li>They’ll collect a favour from you in the nebulous future. </li><!--
				--><li>They demand something else. Something more. </li><!--
				--><li>What they give you isn’t quite what you asked for. </li><!--
			--></ul><!--
			--></textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 10- : </span>
			<textarea name="attr_parlaywiththestrangemiss" class="sheet-actiondesc" placeholder="Miss" title="Miss">On a miss, the GM chooses as many as they want, and maybe the player gets something:<!--
			--><ul><!--
				--><li>They take the other offer too.</li><!--
				--><li>They’ll collect a favour from you in the nebulous future. </li><!--
				--><li>They demand something else. Something more. </li><!--
				--><li>What they give you isn’t quite what you asked for. </li><!--
			--></ul><!--
			--></textarea>
		</div>
	</div>
	
	<!-- Seize the Initiative possible outcomes -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result 20+ : </span>
			<textarea name="attr_seizetheinitiativebest" class="sheet-actiondesc" placeholder="Best Success" title="Best Success">On a 16+, you find cover and take your next steps rationally. On a 20+, you also catch them flat-footed and act before anyone else.
			</textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 16-19 : </span>
			<textarea name="attr_seizetheinitiativesuccess" class="sheet-actiondesc" placeholder="Great Success" title="Great Success">On a 16+, you find cover and take your next steps rationally.
			</textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 11-15 : </span>
			<textarea name="attr_seizetheinitiativepartial" class="sheet-actiondesc" placeholder="Mild Success" title="Mild Success">On an 11-15, choose 1:<!--
			--><ul><!--
				--><li>You see red, rushing in or shooting first, but fail to get to cover.</li><!--
				--><li>You run or hide. You can’t attack, but you’re a low priority target. </li><!--
				--><li>You freeze up after you find cover, and act after everyone else. </li><!--
			--></ul><!--
			--></textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 10- : </span>
			<textarea name="attr_seizetheinitiativemiss" class="sheet-actiondesc" placeholder="Miss" title="Miss">On a miss, the GM chooses 1 for you:<!--
			--><ul><!--
				--><li>You see red, rushing in or shooting first, but fail to get to cover.</li><!--
				--><li>You run or hide. You can’t attack, but you’re a low priority target. </li><!--
				--><li>You freeze up after you find cover, and act after everyone else. </li><!--
			--></ul><!--
			--></textarea>
		</div>
	</div>
	
	<!-- Personal Attack -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Desc : </span>
			<textarea name="attr_personalattackoffensivedesc" class="sheet-actiondesc" placeholder="Best Success" title="Best Success">An 11+ hits for listed damage, a natural 20 is a Crit (against ground targets, x2 damage and ignores armour), a natural 1 is a jam or misfire. When firing against targets in cover or moving planes, only a 16+ hits. <i> When you use a melee weapon against a plane, </i> you may damage a Vital Part of your choice on an 11+ instead of doing structure damage.
			</textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Desc : </span>
			<textarea name="attr_personalattackdefensivedesc" class="sheet-actiondesc" placeholder="Great Success" title="Great Success">An 11+ hits for listed damage, a natural 20 is a Crit (against ground targets, x2 damage and ignores armour), a natural 1 is a jam or misfire. When firing against targets in cover or moving planes, only a 16+ hits.
			</textarea>
		</div>
	</div>
	
	
	<!-- Stress Release Move outcomes -->
	
	<!-- Vent -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result: </span>
			<textarea name="attr_vent" class="sheet-actiondesc" placeholder="Great Success" title="Great Success"><i>When you are Burnt Out and use a Vent action,</i> lose 2 Stress. If one or more of your comrades bears the brunt of the ire or consequences, you lose 3 stress instead, but they take 1 Stress each. 
			</textarea>
		</div>
	</div>
	
	<!-- Indulge in Vice - Familiar -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result: </span>
			<textarea name="attr_indulgeinvicefamiliar" class="sheet-actiondesc" placeholder="Great Success" title="Great Success"><i>When you indulge a Vice,</i> add +1 to the Vice Track.<!--
			--><ul><!--
				--><li><i>If you indulge alone,</i> suffer a consequence</li><!--
				--><li><i>If you and a comrade indulge together,</i> describe how you get disruptive, argumentative, or distracted. </li><!--
			--></ul><!--
			--><i>When you go back to the same Vice again,</i> additionally take 1 miss forward to End of Night, and worsened consequences. </textarea>
		</div>
	</div>
	
	<!-- Indulge in Vice - Unfamiliar -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result: </span>
			<textarea name="attr_indulgeinviceunfamiliardesc" class="sheet-actiondesc" placeholder="Great Success" title="Great Success"><i>When you indulge a Vice,</i> add +1 to the Vice Track.<!--
			--><ul><!--
				--><li><i>If you indulge alone,</i> suffer a consequence</li><!--
				--><li><i>If you and a comrade indulge together,</i> describe how you get disruptive, argumentative, or distracted. </li><!--
			--></ul><!--
			--></textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 16+ : </span>
			<textarea name="attr_indulgeinviceunfamiliarsuccess" class="sheet-actiondesc" placeholder="Great Success" title="Great Success">On a 16+, add it as a Vice.
			</textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 10- : </span>
			<textarea name="attr_indulgeinviceunfamiliarmiss" class="sheet-actiondesc" placeholder="Miss" title="Miss">On a miss, suffer worsened consequences.
			</textarea>
		</div>
	</div>
	
	<!-- End of Night -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result: </span>
			<textarea name="attr_endofnightdesc" class="sheet-actiondesc" placeholder="Great Success" title="Great Success"><i>When you end the night, or hit 5 Vice,</i> roll 1d20 for each mark on the Vice Track, then clear the track. You can spend Attendant holds after you roll to retroactively add a +1 to all dice. On an 11-15, remove 1 Stress. 16+, remove 2 Stress. If you get 3 or more misses (1-10), choose one below:<!--
			--><ul><!--
				--><li>You become Addicted to a Vice you indulged.</li><!--
				--><li>You become Immune to a Vice you indulged.</li><!--
				--><li>You take a -1 Ongoing to all your rolls for the next routine.</li><!--
			--></ul><!--
			--></textarea>
		</div>
	</div>
	
	<!-- Quality Time -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result: </span>
			<textarea name="attr_qualitytime" class="sheet-actiondesc" placeholder="Great Success" title="Great Success"><i>When you devote time and attention to your trusting Confidant,</i> remove 2 Stress. This move can be used once per Routine. 
			</textarea>
		</div>
	</div>
	
	
	
	<!-- Other Ground Move outcomes -->
	
	<!-- Press the Issue possible outcomes -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result 16+ : </span>
			<textarea name="attr_presstheissuesuccess" class="sheet-actiondesc" placeholder="Great Success" title="Great Success">On a hit, they’ll do it.
			</textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 11-15 : </span>
			<textarea name="attr_presstheissuepartial" class="sheet-actiondesc" placeholder="Mild Success" title="Mild Success">On an 11-15, the GM chooses 1:<!--
			--><ul><!--
				--><li>They need something from you first.</li><!--
				--><li>They’ll resent this, and that’ll be a problem later.</li><!--
				--><li>They’ll do it, but only the bare minimum.</li><!--
			--></ul><!--
			--></textarea>
		</div>
	</div>
	
	<!-- Turn on the Charm possible outcomes -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result 16+ : </span>
			<textarea name="attr_turnonthecharmsuccess" class="sheet-actiondesc" placeholder="Great Success" title="Great Success">On a 16+, they choose 2:<!--
			--><ul><!--
				--><li>They throw themselves at you.</li><!--
				--><li>They do you a favour or show you a kindness.</li><!--
				--><li>They’ll listen to what you have to say.</li><!--
			--></ul><!--
			--></textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 11-15 : </span>
			<textarea name="attr_turnonthecharmpartial" class="sheet-actiondesc" placeholder="Mild Success" title="Mild Success">On an 11-15, they choose 1:<!--
			--><ul><!--
				--><li>They throw themselves at you.</li><!--
				--><li>They do you a favour or show you a kindness.</li><!--
				--><li>They’ll listen to what you have to say.</li><!--
			--></ul><!--
			--></textarea>
		</div>
	</div>
	
	<!-- Get Real possible outcomes -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result 16+ : </span>
			<textarea name="attr_getrealsuccess" class="sheet-actiondesc" placeholder="Great Success" title="Great Success">On a hit, you do it. On a 16+, both of you lose 1 additional Stress.
			</textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 11-15 : </span>
			<textarea name="attr_getrealpartial" class="sheet-actiondesc" placeholder="Mild Success" title="Mild Success">On a hit, you do it.
			</textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 10- : </span>
			<textarea name="attr_getrealmiss" class="sheet-actiondesc" placeholder="Miss" title="Miss">On a miss, if the target is a PC, they choose one below, and the GM asks “What did they say which hurt you?” NPCs react at GM discretion.<!--
			--><ul><!--
				--><li>The goal is achieved, but the target has to do most of the work. They don’t lose Stress, and take 1 miss forward to End of Night.</li><!--
				--><li>Both sides must Vent immediately. The target must be the other participant. The requirement to be Burnt Out is waived.</li><!--
				--><li>The target loses 3 Stress as they throw a punch and start a Brawl!</li><!--
			--></ul><!--
			--></textarea>
		</div>
	</div>
	
	<!-- Brawl possible outcomes -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result 16+ : </span>
			<textarea name="attr_brawlsuccess" class="sheet-actiondesc" placeholder="Great Success" title="Great Success">On a 16+, choose 2:<!--
			--><ul><!--
				--><li>Hurt somebody bad.</li><!--
					--><ul><!--
						--><li>Hurt a whole lot of folks.</li><!--
					--></ul><!--
				--><li>Win the fight, whatever that means.</li><!--
				--><li>Get out clean and relatively unscathed.</li><!--
				--><li>Remove 1 Stress.</li><!--
			--></ul><!--
			--></textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 11-15 : </span>
			<textarea name="attr_brawlpartial" class="sheet-actiondesc" placeholder="Mild Success" title="Mild Success">On a 11-15, choose 1:<!--
			--><ul><!--
				--><li>Hurt somebody bad.</li><!--
					--><ul><!--
						--><li>Hurt a whole lot of folks.</li><!--
					--></ul><!--
				--><li>Win the fight, whatever that means.</li><!--
				--><li>Get out clean and relatively unscathed.</li><!--
				--><li>Remove 1 Stress.</li><!--
			--></ul><!--
			--></textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 10- : </span>
			<textarea name="attr_brawlmiss" class="sheet-actiondesc" placeholder="Miss" title="Miss">The consequences of not getting out clean are up to the GM and can include things such as:<!--
			--><ul><!--
				--><li>1 Injury from fighting.</li><!--
				--><li>1 additional injury from fighting very serious people.</li><!--
				--><li>Property damage or social disruption.</li><!--
				--><li>Stress taken.</li><!--
				--><li>Trust being broken.</li><!--
				--><li>A response from whatever passes for law enforcement in the town.</li><!--
			--></ul><!--
			--></textarea>
		</div>
	</div>
	
	

	<!-- Universal Move outcomes -->
	
	<!-- Break Trust -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result: </span>
			<textarea name="attr_breaktrust" class="sheet-actiondesc" placeholder="Great Success" title="Great Success"><i>When you lose trust in a comrade,</i> erase their mark and choose one:<!--
			--><ul><!--
				--><li>Keep your feelings hidden, and <u>take 1 Stress.</u></li><!--
				--><li>Show directly and explicitly how you feel, and <u>remove 1 Stress.</u> </li><!--
			--></ul><!--
			--></textarea>
		</div>
	</div>
	
	<!-- Restore Trust -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result: </span>
			<textarea name="attr_restoretrust" class="sheet-actiondesc" placeholder="Great Success" title="Great Success"><i>When you show faith in a comrade,</i> mark Trust and take 1 Stress. 
			</textarea>
		</div>
	</div>
	
	<!-- Help/Hinder -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result: </span>
			<textarea name="attr_helphinder" class="sheet-actiondesc" placeholder="Great Success" title="Great Success"><i>When you put yourself at risk help a comrade,</i> give them Advantage forward. If you didn’t trust them, Restore Trust. <p></p> <i>When you make a point to hinder a comrade,</i> give them Disadvantage forward. If you trusted them, Break Trust. 
			</textarea>
		</div>
	</div>
	
	<!-- Discover Beauty -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result: </span>
			<textarea name="attr_discoverbeauty" class="sheet-actiondesc" placeholder="Great Success" title="Great Success"><i>Once per routine, when you witness beauty in the world,</i> describe how you are moved by what you see, and lose 1 Stress. 
			</textarea>
		</div>
	</div>
	
	
	
	<!-- Mastery Move outcomes -->
	
	<!-- Slipstream Mastery - Dangeroud Merge -->
	<div class="hidden">
		<div class="sheet-action">
			<span class="sheet-action">Result 16+ : </span>
			<textarea name="attr_dangerousmergesuccess" class="sheet-actiondesc" placeholder="Great Success" title="Great Success">On a 16+, your foes collide.
			</textarea>
		</div>
		<div class="sheet-action">
			<span class="sheet-action">Result 11-15 : </span>
			<textarea name="attr_dangerousmergepartial" class="sheet-actiondesc" placeholder="Mild Success" title="Mild Success">On an 11-15, they are both made vulnerable while recovering, as per Tables Have Turned.
			</textarea>
		</div>
	</div>
	
	
	
	
</div>

</html>






<!-- Roll template -->


<rolltemplate class="sheet-rolltemplate-com">
    <table>
        <tr><th>{{char}}<br>rolls {{move}} </th></tr>
        {{#statused}}
			<tr><td><span>With </span> {{statused}}</td></tr>
		{{/statused}}
        <tr>
            <td><span>Result: </span>{{check}} </td>
        </tr>
		{{#infodesc}}
			<tr><td colspan="2"><div class="movedesc">{{infodesc}}</div></td></tr>
		{{/infodesc}}
        <tr></tr>
        {{#check}}
            {{#rollTotal() showroll 1}}
                <tr>
                    <td>
                        {{#rollGreater() check 15}}
                            <span style="color: green;font-weight:bold;">Full Hit</span>
                        {{/rollGreater() check 15}}
                        {{#rollBetween() check 11 15}}
                            <span style="color: black;font-weight:bold;">Partial Hit</span>
                        {{/rollBetween() check 11 15}}
                        {{#rollLess() check 11}}
                            <span style="color: red;font-weight:bold;">Miss</span>
                        {{/rollLess() check 11}}
                    </td>
                </tr>
                {{#success}}
                    {{#rollGreater() check 15}}
                        <tr><td colspan="2"><div class="movedesc">{{success}}</div></td></tr>
                    {{/rollGreater() check 15}}
                {{/success}}
                {{#partial}}
                    {{#rollBetween() check 11 15}}
                        <tr><td colspan="2"><div class="movedesc">{{partial}}</div></td></tr>
                    {{/rollBetween() check 11 15}}
                {{/partial}}
                {{#miss}}
                    {{#rollLess() check 11}}
                        <tr><td colspan="2"><div class="movedesc">{{miss}}</div></td></tr>
                    {{/rollLess() check 11}}
                {{/miss}}
            {{/rollTotal() showroll 1}}
        {{/check}}
    </table>
</rolltemplate>

<!-- Roll template - 20+ -->


<rolltemplate class="sheet-rolltemplate-com20">
    <table>
        <tr><th>{{char}}<br>rolls {{move}} </th></tr>
        {{#statused}}
			<tr><td><span>With </span> {{statused}}</td></tr>
		{{/statused}}
        <tr>
            <td><span>Result: </span>{{check}} </td>
        </tr>
		{{#infodesc}}
			<tr><td colspan="2"><div class="movedesc">{{infodesc}}</div></td></tr>
		{{/infodesc}}
        <tr></tr>
        {{#check}}
            {{#rollTotal() showroll 1}}
                <tr>
                    <td>
                        {{#rollGreater() check 19}}
                            <span style="color: green;font-weight:bold;">Best Hit</span>
                        {{/rollGreater() check 19}}
						{{#rollBetween() check 16 19}}
                            <span style="color: black;font-weight:bold;">Full Hit</span>
                        {{/rollBetween() check 16 19}}
                        {{#rollBetween() check 11 15}}
                            <span style="color: black;font-weight:bold;">Partial Hit</span>
                        {{/rollBetween() check 11 15}}
                        {{#rollLess() check 11}}
                            <span style="color: red;font-weight:bold;">Miss</span>
                        {{/rollLess() check 11}}
                    </td>
                </tr>
				{{#best}}
                    {{#rollGreater() check 19}}
                        <tr><td colspan="2"><div class="movedesc">{{best}}</div></td></tr>
                    {{/rollGreater() check 19}}
                {{/best}}
                {{#success}}
                    {{#rollBetween() check 16 19}}
                        <tr><td colspan="2"><div class="movedesc">{{success}}</div></td></tr>
                    {{/rollBetween() check 16 19}}
                {{/success}}
                {{#partial}}
                    {{#rollBetween() check 11 15}}
                        <tr><td colspan="2"><div class="movedesc">{{partial}}</div></td></tr>
                    {{/rollBetween() check 11 15}}
                {{/partial}}
                {{#miss}}
                    {{#rollLess() check 11}}
                        <tr><td colspan="2"><div class="movedesc">{{miss}}</div></td></tr>
                    {{/rollLess() check 11}}
                {{/miss}}
            {{/rollTotal() showroll 1}}
        {{/check}}
    </table>
</rolltemplate>


<!-- Roll template - custom roll parsing -->


<rolltemplate class="sheet-rolltemplate-comroll">
    <table>
        <tr><th>{{char}}<br>rolls {{move}} </th></tr>
        {{#statused}}
			<tr><td><span>With </span> {{statused}}</td></tr>
		{{/statused}}
        <tr>
            <td><span>Result: </span>{{computed::check}} </td>
        </tr>
		{{#advroll}}
		<tr>
            <td><span>Advantage Die: </span>{{computed::advroll}}
			{{#rollLess() computed::advroll 2}}
                <span style="color: red;font-weight:bold;"> &nbsp; &nbsp; Fault</span>
            {{/rollLess() computed::advroll 2}}
			</td>
        </tr>
		{{/advroll}}
		{{#disroll}}
		<tr>
            <td><span>Disadvantage Die: </span>{{computed::disroll}}
			{{#rollGreater() computed::disroll 9}}
                <span style="color: red;font-weight:bold;"> &nbsp; &nbsp; Fault</span>
            {{/rollGreater() computed::disroll 9}}
			</td>
        </tr>
		{{/disroll}}
		{{#infodesc}}
			<tr><td colspan="2"><div class="movedesc">{{infodesc}}</div></td></tr>
		{{/infodesc}}
        <tr></tr>
        {{#check}}
            {{#rollTotal() showroll 1}}
                <tr>
                    <td>
                        {{#rollGreater() computed::check 15}}
                            <span style="color: green;font-weight:bold;">Full Hit</span>
                        {{/rollGreater() computed::check 15}}
                        {{#rollBetween() computed::check 11 15}}
                            <span style="color: black;font-weight:bold;">Partial Hit</span>
                        {{/rollBetween() computed::check 11 15}}
                        {{#rollLess() computed::check 11}}
                            <span style="color: red;font-weight:bold;">Miss</span>
                        {{/rollLess() computed::check 11}}
                    </td>
                </tr>
                {{#success}}
                    {{#rollGreater() computed::check 15}}
                        <tr><td colspan="2"><div class="movedesc">{{success}}</div></td></tr>
                    {{/rollGreater() computed::check 15}}
                {{/success}}
                {{#partial}}
                    {{#rollBetween() computed::check 11 15}}
                        <tr><td colspan="2"><div class="movedesc">{{partial}}</div></td></tr>
                    {{/rollBetween() computed::check 11 15}}
                {{/partial}}
                {{#miss}}
                    {{#rollLess() computed::check 11}}
                        <tr><td colspan="2"><div class="movedesc">{{miss}}</div></td></tr>
                    {{/rollLess() computed::check 11}}
                {{/miss}}
            {{/rollTotal() showroll 1}}
        {{/check}}
    </table>
</rolltemplate>

<!-- Roll template - custom roll parsing - 20+ -->


<rolltemplate class="sheet-rolltemplate-comroll20">
    <table>
        <tr><th>{{char}}<br>rolls {{move}} </th></tr>
        {{#statused}}
			<tr><td><span>With </span> {{statused}}</td></tr>
		{{/statused}}
        <tr>
            <td><span>Result: </span>{{computed::check}} </td>
        </tr>
		{{#advroll}}
		<tr>
            <td><span>Advantage Die: </span>{{computed::advroll}}
			{{#rollLess() computed::advroll 2}}
                <span style="color: red;font-weight:bold;"> &nbsp; &nbsp; Fault</span>
            {{/rollLess() computed::advroll 2}}
			</td>
        </tr>
		{{/advroll}}
		{{#disroll}}
		<tr>
            <td><span>Disadvantage Die: </span>{{computed::disroll}}
			{{#rollGreater() computed::disroll 9}}
                <span style="color: red;font-weight:bold;"> &nbsp; &nbsp; Fault</span>
            {{/rollGreater() computed::disroll 9}}
			</td>
        </tr>
		{{/disroll}}
		{{#infodesc}}
			<tr><td colspan="2"><div class="movedesc">{{infodesc}}</div></td></tr>
		{{/infodesc}}
        <tr></tr>
        {{#check}}
            {{#rollTotal() showroll 1}}
                <tr>
                    <td>
                        {{#rollGreater() computed::check 19}}
                            <span style="color: green;font-weight:bold;">Best Hit</span>
                        {{/rollGreater() computed::check 19}}
						{{#rollBetween() computed::check 16 19}}
                            <span style="color: black;font-weight:bold;">Full Hit</span>
                        {{/rollBetween() computed::check 16 19}}
                        {{#rollBetween() computed::check 11 15}}
                            <span style="color: black;font-weight:bold;">Partial Hit</span>
                        {{/rollBetween() computed::check 11 15}}
                        {{#rollLess() computed::check 11}}
                            <span style="color: red;font-weight:bold;">Miss</span>
                        {{/rollLess() computed::check 11}}
                    </td>
                </tr>
                {{#best}}
                    {{#rollGreater() computed::check 19}}
                        <tr><td colspan="2"><div class="movedesc">{{best}}</div></td></tr>
                    {{/rollGreater() computed::check 19}}
                {{/best}}
                {{#success}}
                    {{#rollBetween() computed::check 16 19}}
                        <tr><td colspan="2"><div class="movedesc">{{success}}</div></td></tr>
                    {{/rollBetween() computed::check 16 19}}
                {{/success}}
                {{#partial}}
                    {{#rollBetween() computed::check 11 15}}
                        <tr><td colspan="2"><div class="movedesc">{{partial}}</div></td></tr>
                    {{/rollBetween() computed::check 11 15}}
                {{/partial}}
                {{#miss}}
                    {{#rollLess() computed::check 11}}
                        <tr><td colspan="2"><div class="movedesc">{{miss}}</div></td></tr>
                    {{/rollLess() computed::check 11}}
                {{/miss}}
            {{/rollTotal() showroll 1}}
        {{/check}}
    </table>
</rolltemplate>

<!-- Roll template - custom roll parsing - end of night -->

<rolltemplate class="sheet-rolltemplate-comrolleon">
    <table>
        <tr><th>{{char}}<br>rolls {{move}} </th></tr>
		{{#infodesc}}
			<tr><td colspan="2"><div class="movedesc">{{infodesc}}</div></td></tr>
		{{/infodesc}}
        <tr>
            <td><span>Result: </span>{{computed::check}} </td>
        </tr>
		{{#stressremoved}}
		<tr>
            <td><span>Stress Removed: </span>{{computed::stressremoved}}</td>
        </tr>
		{{/stressremoved}}
		{{#misses}}
		<tr>
            <td><span>Misses: </span>{{computed::misses}}</td>
        </tr>
		{{/misses}}
		
    </table>
</rolltemplate>

<!-- Roll template - custom roll parsing - personal attack -->

<rolltemplate class="sheet-rolltemplate-comrollpa">
    <table>
        <tr><th>{{char}}<br>rolls {{move}} </th></tr>
		{{#infodesc}}
			<tr><td colspan="2"><div class="movedesc">{{infodesc}}</div></td></tr>
		{{/infodesc}}
        <tr>
            <td><span>Raw Result: </span>{{computed::raw}} </td>
        </tr>
		{{#droppeddie}}
		<tr>
            <td><span>Dropped Die: </span>{{computed::droppeddie}}</td>
        </tr>
		{{/droppeddie}}
		<tr>
            <td><span>Modifier: </span>{{computed::modifier}} </td>
        </tr>
		<tr>
            <td><span>Modified Result: </span>{{computed::check}} </td>
        </tr>
		{{#hitsregular}}
		<tr>
            <td><span>11+ Hits: </span>{{computed::hitsregular}}</td>
        </tr>
		{{/hitsregular}}
		{{#hitsbetter}}
		<tr>
            <td><span>16+ Hits: </span>{{computed::hitsbetter}}</td>
        </tr>
		{{/hitsbetter}}
		{{#crits}}
		<tr>
            <td><span>Crits: </span>{{computed::crits}}</td>
        </tr>
		{{/crits}}
		{{#natones}}
		<tr>
            <td><span>Natural Ones: </span>{{computed::natones}}</td>
        </tr>
		{{/natones}}
		
    </table>
</rolltemplate>

<!-- Roll template - version for when there is only text, no rolling -->


<rolltemplate class="sheet-rolltemplate-comtext">
    <table>
        <tr><th>{{char}}<br>rolls {{move}}</th></tr>
        {{#movedescription}}

             <tr><td colspan="2"><div class="movedesc">{{movedescription}}</div></td></tr>
             
        {{/movedescription}}
    </table>
</rolltemplate>






<script type="text/worker">
  
  // Advantage roll
  const initiateRollAdv = async function(event){
  
  let [section,rowID,button] = parseClickTrigger(event.triggerName);//Returns an array with values of ['repeating_section','rowID','button name']
    let message = `&{template:comroll} {{char=@{character_name}}} {{showroll=[[1]]}}  {{check=[[0[computed result]]]}} {{advroll=[[0[computed roll]]]}} {{roll1=[[1d10]]}} {{roll2=[[1d10]]}} {{roll3=[[1d10]]}} ${rollContent[button]}`;
    let roll = await startRoll(message);
    const computeObj = {};
	
  //const roll = await startRoll('&{template:comroll} {{showroll=[[1]]}}  {{check=[[0[computed result]]]}} {{advroll=[[0[computed roll]]]}} {{roll1=[[1d10]]}} {{roll2=[[1d10]]}} {{roll3=[[1d10]]}}');
  //const computeObj = {};
  
  let rollResults = [1,2,3].map((num)=>roll.results[`roll${num}`]);
  console.log("Original rolls");
  console.log(rollResults);
  let result = rollResults.map(a => a.result);
  console.log("Original rolls - easier format");
  console.log(result);
  let lowerResults = [];
  var max1 = Math.max.apply(null, result); // get the max of the array
  console.log("Max die");
  console.log(max1);
  result.splice(result.indexOf(max1), 1); // remove max from the array

  console.log("Next two dice");
  console.log(result);
  console.log("Roll mod");
  console.log(roll.results.rollmod.result);
  let rollmod = roll.results.rollmod.result;
  let max2 =  Math.max.apply(null, result);
  console.log("Second max die");
  console.log(max2);
  computeObj.check = max1 + max2 + rollmod;
  
  computeObj.advroll = _.last(result);//Get the last die - the advantage die's result
  finishRoll(roll.rollId,computeObj);
};

// Disadvantage roll
  const initiateRollDis = async function(event){
  
  let [section,rowID,button] = parseClickTrigger(event.triggerName);//Returns an array with values of ['repeating_section','rowID','button name']
    let message = `&{template:comroll} {{char=@{character_name}}} {{showroll=[[1]]}}  {{check=[[0[computed result]]]}} {{disroll=[[0[computed roll]]]}} {{roll1=[[1d10]]}} {{roll2=[[1d10]]}} {{roll3=[[1d10]]}} ${rollContent[button]}`;
    let roll = await startRoll(message);
    const computeObj = {};
	
  //const roll = await startRoll('&{template:comroll} {{showroll=[[1]]}}  {{check=[[0[computed result]]]}} {{advroll=[[0[computed roll]]]}} {{roll1=[[1d10]]}} {{roll2=[[1d10]]}} {{roll3=[[1d10]]}}');
  //const computeObj = {};
  
  let rollResults = [1,2,3].map((num)=>roll.results[`roll${num}`]);
  console.log("Original rolls");
  console.log(rollResults);
  let result = rollResults.map(a => a.result);
  console.log("Original rolls - easier format");
  console.log(result);
  let lowerResults = [];
  var min1 = Math.min.apply(null, result); // get the min of the array
  console.log("Min die");
  console.log(min1);
  result.splice(result.indexOf(min1), 1); // remove min from the array

  console.log("Next two dice");
  console.log(result);
  console.log("Roll mod");
  console.log(roll.results.rollmod.result);
  let rollmod = roll.results.rollmod.result;
  let min2 =  Math.min.apply(null, result);
  console.log("Second min die");
  console.log(min2);
  computeObj.check = min1 + min2 + rollmod;
  
  computeObj.disroll = _.last(result);//Get the last die - the disadvantage die's result
  finishRoll(roll.rollId,computeObj);
};

// Advantage roll - 20+ template
  const initiateRollAdv20 = async function(event){
  
  let [section,rowID,button] = parseClickTrigger(event.triggerName);//Returns an array with values of ['repeating_section','rowID','button name']
    let message = `&{template:comroll20} {{char=@{character_name}}} {{showroll=[[1]]}}  {{check=[[0[computed result]]]}} {{advroll=[[0[computed roll]]]}} {{roll1=[[1d10]]}} {{roll2=[[1d10]]}} {{roll3=[[1d10]]}} ${rollContent[button]}`;
    let roll = await startRoll(message);
    const computeObj = {};
	
  //const roll = await startRoll('&{template:comroll} {{showroll=[[1]]}}  {{check=[[0[computed result]]]}} {{advroll=[[0[computed roll]]]}} {{roll1=[[1d10]]}} {{roll2=[[1d10]]}} {{roll3=[[1d10]]}}');
  //const computeObj = {};
  
  let rollResults = [1,2,3].map((num)=>roll.results[`roll${num}`]);
  console.log("Original rolls");
  console.log(rollResults);
  let result = rollResults.map(a => a.result);
  console.log("Original rolls - easier format");
  console.log(result);
  let lowerResults = [];
  var max1 = Math.max.apply(null, result); // get the max of the array
  console.log("Max die");
  console.log(max1);
  result.splice(result.indexOf(max1), 1); // remove max from the array

  console.log("Next two dice");
  console.log(result);
  console.log("Roll mod");
  console.log(roll.results.rollmod.result);
  let rollmod = roll.results.rollmod.result;
  let max2 =  Math.max.apply(null, result);
  console.log("Second max die");
  console.log(max2);
  computeObj.check = max1 + max2 + rollmod;
  
  computeObj.advroll = _.last(result);//Get the last die - the advantage die's result
  finishRoll(roll.rollId,computeObj);
};

// Disadvantage roll - 20+ template
  const initiateRollDis20 = async function(event){
  
  let [section,rowID,button] = parseClickTrigger(event.triggerName);//Returns an array with values of ['repeating_section','rowID','button name']
    let message = `&{template:comroll20} {{char=@{character_name}}} {{showroll=[[1]]}}  {{check=[[0[computed result]]]}} {{disroll=[[0[computed roll]]]}} {{roll1=[[1d10]]}} {{roll2=[[1d10]]}} {{roll3=[[1d10]]}} ${rollContent[button]}`;
    let roll = await startRoll(message);
    const computeObj = {};
	
  //const roll = await startRoll('&{template:comroll} {{showroll=[[1]]}}  {{check=[[0[computed result]]]}} {{advroll=[[0[computed roll]]]}} {{roll1=[[1d10]]}} {{roll2=[[1d10]]}} {{roll3=[[1d10]]}}');
  //const computeObj = {};
  
  let rollResults = [1,2,3].map((num)=>roll.results[`roll${num}`]);
  console.log("Original rolls");
  console.log(rollResults);
  let result = rollResults.map(a => a.result);
  console.log("Original rolls - easier format");
  console.log(result);
  let lowerResults = [];
  var min1 = Math.min.apply(null, result); // get the min of the array
  console.log("Min die");
  console.log(min1);
  result.splice(result.indexOf(min1), 1); // remove min from the array

  console.log("Next two dice");
  console.log(result);
  console.log("Roll mod");
  console.log(roll.results.rollmod.result);
  let rollmod = roll.results.rollmod.result;
  let min2 =  Math.min.apply(null, result);
  console.log("Second min die");
  console.log(min2);
  computeObj.check = min1 + min2 + rollmod;
  
  computeObj.disroll = _.last(result);//Get the last die - the disadvantage die's result
  finishRoll(roll.rollId,computeObj);
};

const parseClickTrigger = function(string){
  let match = string.match(/clicked:(?:(repeating_[^_]+)_([^_]+)_)?(.+)/);
  match.shift();
  return match;
};

//Content for advantage and disadvantage rolls is identifal here
const rollContent = {
    advexplorethewild:'{{rollmod=[[@{daring} + @{roll_mod} - @{injury}]]}} {{move=Explore the Wild}} {{statused=Daring}} {{success=@{explorethewildsuccess}}} {{partial=@{explorethewildpartial}}} {{miss=@{genericmiss}}}',
	disexplorethewild:'{{rollmod=[[@{daring} + @{roll_mod} - @{injury}]]}} {{move=Explore the Wild}} {{statused=Daring}} {{success=@{explorethewildsuccess}}} {{partial=@{explorethewildpartial}}} {{miss=@{genericmiss}}}',
	advconfrontyourfears:'{{rollmod=[[ @{roll_mod}]]}} {{move=Confront Your Fears}}  {{success=@{confrontyourfearssuccess}}} {{partial=@{confrontyourfearspartial}}} {{miss=@{confrontyourfearsmiss}}}',
	disconfrontyourfears:'{{rollmod=[[ @{roll_mod}]]}} {{move=Confront Your Fears}}  {{success=@{confrontyourfearssuccess}}} {{partial=@{confrontyourfearspartial}}} {{miss=@{confrontyourfearsmiss}}}',
	adv20parlaywiththestrange:'{{rollmod=[[ @{roll_mod}]]}} {{move=Parlay with the Strange}} {{best=@{parlaywiththestrangebest}}} {{success=@{parlaywiththestrangesuccess}}} {{partial=@{parlaywiththestrangepartial}}} {{miss=@{parlaywiththestrangemiss}}}',
	dis20parlaywiththestrange:'{{rollmod=[[ @{roll_mod}]]}} {{move=Parlay with the Strange}} {{best=@{parlaywiththestrangebest}}} {{success=@{parlaywiththestrangesuccess}}} {{partial=@{parlaywiththestrangepartial}}} {{miss=@{parlaywiththestrangemiss}}}',
	adv20seizetheinitiative:'{{rollmod=[[ @{daring} + @{roll_mod} - @{injury}]]}} {{move=Seize the Initiative}} {{statused=Daring}} {{best=@{seizetheinitiativebest}}} {{success=@{seizetheinitiativesuccess}}} {{partial=@{seizetheinitiativepartial}}} {{miss=@{seizetheinitiativemiss}}}',
	dis20seizetheinitiative:'{{rollmod=[[ @{daring} + @{roll_mod} - @{injury}]]}} {{move=Seize the Initiative}} {{statused=Daring}} {{best=@{seizetheinitiativebest}}} {{success=@{seizetheinitiativesuccess}}} {{partial=@{seizetheinitiativepartial}}} {{miss=@{seizetheinitiativemiss}}}',
	advindulgeinviceunfamiliar:'{{rollmod=[[@{daring} + @{roll_mod} - @{injury}]]}} {{move=Indulge in Vice - Unfamiliar}} {{statused=Daring}} {{success=@{indulgeinviceunfamiliarsuccess}}} {{infodesc=@{indulgeinviceunfamiliardesc}}} {{miss=@{indulgeinviceunfamiliarmiss}}}',
	disindulgeinviceunfamiliar:'{{rollmod=[[@{daring} + @{roll_mod} - @{injury}]]}} {{move=Indulge in Vice - Unfamiliar}} {{statused=Daring}} {{success=@{indulgeinviceunfamiliarsuccess}}} {{infodesc=@{indulgeinviceunfamiliardesc}}} {{miss=@{indulgeinviceunfamiliarmiss}}}',
	advpresstheissue:'{{rollmod=[[?{When you try to get somebody to do what you want…|with Money pay their price and they’ll do it - no roll,0|with intimidation or force roll +Hard,@{hard}|with honest reasoning roll +Calm,@{calm}|with lies or misdirection roll +Keen,@{keen}} + @{roll_mod} - @{injury}]]}} {{move=Press the Issue}}  {{success=@{presstheissuesuccess}}} {{partial=@{presstheissuepartial}}} {{miss=@{genericmiss}}}',
	dispresstheissue:'{{rollmod=[[?{When you try to get somebody to do what you want…|with Money pay their price and they’ll do it - no roll,0|with intimidation or force roll +Hard,@{hard}|with honest reasoning roll +Calm,@{calm}|with lies or misdirection roll +Keen,@{keen}} + @{roll_mod} - @{injury}]]}} {{move=Press the Issue}}  {{success=@{presstheissuesuccess}}} {{partial=@{presstheissuepartial}}} {{miss=@{genericmiss}}}',
	advturnonthecharm:'{{rollmod=[[@{daring} + @{roll_mod} - @{injury}]]}} {{move=Turn on the Charm}} {{statused=Daring}} {{success=@{turnonthecharmsuccess}}} {{partial=@{turnonthecharmpartial}}} {{miss=@{genericmiss}}}',
	disturnonthecharm:'{{rollmod=[[@{daring} + @{roll_mod} - @{injury}]]}} {{move=Turn on the Charm}} {{statused=Daring}} {{success=@{turnonthecharmsuccess}}} {{partial=@{turnonthecharmpartial}}} {{miss=@{genericmiss}}}',
	advgetreal:'{{rollmod=[[@{calm} + @{roll_mod} - @{injury}]]}} {{move=Get Real}} {{statused=Calm}} {{success=@{getrealsuccess}}} {{partial=@{getrealpartial}}} {{miss=@{getrealmiss}}} {{infodesc=?{When you speak the truth from your heart and they are willing to listen choose a goal from below and take 1 Stress.|Take them as a Confidant repair a relationship.|Begin a Move Exchange.|Remove 3 Stress between the two of you however you choose.|Offer them a chance to Rethink their Life (p.123). You choose the stats that change and if they accept they don’t spend any XP.}}}',
	disgetreal:'{{rollmod=[[@{calm} + @{roll_mod} - @{injury}]]}} {{move=Get Real}} {{statused=Calm}} {{success=@{getrealsuccess}}} {{partial=@{getrealpartial}}} {{miss=@{getrealmiss}}} {{infodesc=?{When you speak the truth from your heart and they are willing to listen choose a goal from below and take 1 Stress.|Take them as a Confidant repair a relationship.|Begin a Move Exchange.|Remove 3 Stress between the two of you however you choose.|Offer them a chance to Rethink their Life (p.123). You choose the stats that change and if they accept they don’t spend any XP.}}}',
	advbrawl:'{{rollmod=[[@{hard} + @{roll_mod} - @{injury}]]}} {{move=Brawl}} {{statused=Hard}} {{success=@{brawlsuccess}}} {{partial=@{brawlpartial}}} {{miss=@{brawlmiss}}}',
	disbrawl:'{{rollmod=[[@{hard} + @{roll_mod} - @{injury}]]}} {{move=Brawl}} {{statused=Hard}} {{success=@{brawlsuccess}}} {{partial=@{brawlpartial}}} {{miss=@{brawlmiss}}}',
	advdangerousmerge:'{{rollmod=[[@{daring} + @{roll_mod} - @{injury}]]}} {{move=Dangerous Merge}} {{statused=Daring}} {{success=@{dangerousmergesuccess}}} {{partial=@{dangerousmergepartial}}} {{miss=@{genericmiss}}}',
	disdangerousmerge:'{{rollmod=[[@{daring} + @{roll_mod} - @{injury}]]}} {{move=Dangerous Merge}} {{statused=Daring}} {{success=@{dangerousmergesuccess}}} {{partial=@{dangerousmergepartial}}} {{miss=@{genericmiss}}}'
};



const rollButtonsAdv = ["advexplorethewild","advconfrontyourfears","advindulgeinviceunfamiliar","advpresstheissue","advturnonthecharm","advgetreal","advbrawl","advdangerousmerge"];
rollButtonsAdv.forEach((button)=>{
    on(`clicked:${button}`,initiateRollAdv);
});

const rollButtonsDis = ["disexplorethewild","disconfrontyourfears","disindulgeinviceunfamiliar","dispresstheissue","disturnonthecharm","disgetreal","disbrawl","disdangerousmerge"];
rollButtonsDis.forEach((button)=>{
    on(`clicked:${button}`,initiateRollDis);
});

//Versions for the template with 20+ giving a new result
const rollButtonsAdv20 = ["adv20parlaywiththestrange","adv20seizetheinitiative"];
rollButtonsAdv20.forEach((button)=>{
    on(`clicked:${button}`,initiateRollAdv20);
});

const rollButtonsDis20 = ["dis20parlaywiththestrange","dis20seizetheinitiative"];
rollButtonsDis20.forEach((button)=>{
    on(`clicked:${button}`,initiateRollDis20);
});


//Used by other functions
let returnLarger = (arr, num) => {
  return arr.reduce((acc, curr)=>{  
    if(curr > num){
      return acc.concat(curr)  // Concatenate the acc with arr
    }else{
      return acc
    }
  }, [])   // Initialize the accumulator with an empty array
}


  const rollStateRadioValues = ["advantage","flat","disadvantage"];
  rollStateRadioValues.forEach(function(value) {
    on(`clicked:roll_state_${value}`, function() {
      setAttrs({
        ["rollstate"]: value
      });
    });
  });
  
  const statHideValues = ["true","false"];
	statHideValues.forEach(function(value) {
    on(`clicked:hideresetstats_${value}`, function() {
      setAttrs({
        ["hideresetstats"]: value
      });
    });
	
	on(`clicked:hidebushwackmastery_${value}`, function() {
      setAttrs({
        ["hidebushwackmastery"]: value
      });
    });
	on(`clicked:hidebushwackmasteryunchecked_${value}`, function() {
      setAttrs({
        ["hidebushwackmasteryunchecked"]: value
      });
    });
	
	on(`clicked:hideslipstreammastery_${value}`, function() {
      setAttrs({
        ["hideslipstreammastery"]: value
      });
    });
	on(`clicked:hideslipstreammasteryunchecked_${value}`, function() {
      setAttrs({
        ["hideslipstreammasteryunchecked"]: value
      });
    });
	
	on(`clicked:hidedogfightermastery_${value}`, function() {
      setAttrs({
        ["hidedogfightermastery"]: value
      });
    });
	on(`clicked:hidedogfightermasteryunchecked_${value}`, function() {
      setAttrs({
        ["hidedogfightermasteryunchecked"]: value
      });
    });
	
	on(`clicked:hidesharpshootermastery_${value}`, function() {
      setAttrs({
        ["hidesharpshootermastery"]: value
      });
    });
	on(`clicked:hidesharpshootermasteryunchecked_${value}`, function() {
      setAttrs({
        ["hidesharpshootermasteryunchecked"]: value
      });
    });
	
	});
  
  
  
  //Reset Stats to starting stats for selected stat package (by playbook)
	const attributes = ["statpackage","hard","keen","calm","daring","wild"];
	on('clicked:resetstats', () => {
		
		getAttrs(attributes, function(values) {
			const statpackage = values.statpackage.trim();
			let hardnew = values.hard || 0;
			let keennew = values.keen || 0;
			let calmnew = values.calm || 0;
			let daringnew = values.daring || 0;
			let wildnew = values.wild || 0;
			
			if (statpackage === "devotee") {
		
				hardnew = 2;
				keennew = -2;
				calmnew = 2;
				daringnew = 0;
				wildnew = 0;
			}
			else if (statpackage === "wanderer") {
		
				hardnew = -2;
				keennew = -1;
				calmnew = 4;
				daringnew = 1;
				wildnew = 0;
			}
			else if (statpackage === "cryptic") {
		
				hardnew = -1;
				keennew = 2;
				calmnew = 3;
				daringnew = -2;
				wildnew = 0;
			}
			else if (statpackage === "shark") {
		
				hardnew = 3;
				keennew = -2;
				calmnew = 3;
				daringnew = -2;
				wildnew = 0;
			}
			else if (statpackage === "wideeyed") {
		
				hardnew = -1;
				keennew = -2;
				calmnew = 1;
				daringnew = 4;
				wildnew = 2;
			}
			else if (statpackage === "scholar") {
		
				hardnew = -1;
				keennew = 2;
				calmnew = 4;
				daringnew = -3;
				wildnew = 2;
			}
			else if (statpackage === "avenger") {
		
				hardnew = 3;
				keennew = 2;
				calmnew = -2;
				daringnew = -1;
				wildnew = 2;
			}
			else if (statpackage === "recluse") {
		
				hardnew = -2;
				keennew = 3;
				calmnew = 3;
				daringnew = -2;
				wildnew = 2;
			}
			else if (statpackage === "bushpilot") {
		
				hardnew = -1;
				keennew = 2;
				calmnew = -3;
				daringnew = 4;
				wildnew = 0;
			}
			else if (statpackage === "huntsman") {
		
				hardnew = 3;
				keennew = -1;
				calmnew = -2;
				daringnew = 2;
				wildnew = 0;
			}
			else if (statpackage === "escapist") {
		
				hardnew = -4;
				keennew = 3;
				calmnew = 0;
				daringnew = 3;
				wildnew = 0;
			}
			else if (statpackage === "bumpkin") {
		
				hardnew = 0;
				keennew = -3;
				calmnew = 3;
				daringnew = 2;
				wildnew = 0;
			}
			else if (statpackage === "blueblood") {
		
				hardnew = 2;
				keennew = -2;
				calmnew = 2;
				daringnew = 0;
				wildnew = 0;
			}
			else if (statpackage === "blowhard") {
		
				hardnew = -3;
				keennew = 4;
				calmnew = 4;
				daringnew = -3;
				wildnew = 0;
			}
			else if (statpackage === "recruit") {
		
				hardnew = 1;
				keennew = 1;
				calmnew = 0;
				daringnew = 0;
				wildnew = 0;
			}
			else if (statpackage === "professional") {
		
				hardnew = 3;
				keennew = 0;
				calmnew = 1;
				daringnew = -2;
				wildnew = 0;
			}
			else if (statpackage === "singleminded") {
		
				hardnew = 3;
				keennew = 0;
				calmnew = -4;
				daringnew = 3;
				wildnew = 0;
			}
			else if (statpackage === "intellectual") {
		
				hardnew = -2;
				keennew = 3;
				calmnew = 3;
				daringnew = -2;
				wildnew = 0;
			}
			else if (statpackage === "enforcer") {
		
				hardnew = 3;
				keennew = -2;
				calmnew = 2;
				daringnew = -1;
				wildnew = 0;
			}
			else if (statpackage === "dreamer") {
		
				hardnew = -3;
				keennew = 1;
				calmnew = 2;
				daringnew = 2;
				wildnew = 0;
			}
			else if (statpackage === "wingwalker") {
		
				hardnew = -2;
				keennew = -2;
				calmnew = 2;
				daringnew = 4;
				wildnew = 0;
			}
			else if (statpackage === "trickster") {
		
				hardnew = -3;
				keennew = 3;
				calmnew = -1;
				daringnew = 3;
				wildnew = 0;
			}
			else if (statpackage === "defender") {
		
				hardnew = 2;
				keennew = 0;
				calmnew = -2;
				daringnew = 2;
				wildnew = 0;
			}
			else if (statpackage === "trader") {
		
				hardnew = -1;
				keennew = -2;
				calmnew = 3;
				daringnew = 2;
				wildnew = 0;
			}
			else if (statpackage === "researcher") {
		
				hardnew = 0;
				keennew = 2;
				calmnew = 0;
				daringnew = -1;
				wildnew = 0;
			}
			else if (statpackage === "inventor") {
		
				hardnew = -1;
				keennew = -2;
				calmnew = 2;
				daringnew = 2;
				wildnew = 0;
			}
			else if (statpackage === "tourist") {
		
				hardnew = 1;
				keennew = 1;
				calmnew = -2;
				daringnew = 1;
				wildnew = 0;
			}
			else if (statpackage === "studybuddy") {
		
				hardnew = 0;
				keennew = 2;
				calmnew = 2;
				daringnew = -3;
				wildnew = 0;
			}
			else if (statpackage === "feral") {
		
				hardnew = 3;
				keennew = 3;
				calmnew = -2;
				daringnew = -2;
				wildnew = 0;
			}
			else if (statpackage === "wideeyed2") {
		
				hardnew = -4;
				keennew = 3;
				calmnew = 2;
				daringnew = 1;
				wildnew = 0;
			}
			else if (statpackage === "recluse2") {
		
				hardnew = -2;
				keennew = 3;
				calmnew = 3;
				daringnew = -2;
				wildnew = 0;
			}
			else if (statpackage === "resigned") {
		
				hardnew = 0;
				keennew = 2;
				calmnew = -2;
				daringnew = 2;
				wildnew = 0;
			}
			else if (statpackage === "fahnenjunker") {
		
				hardnew = 3;
				keennew = 1;
				calmnew = -2;
				daringnew = 0;
				wildnew = 0;
			}
			else if (statpackage === "highborn") {
		
				hardnew = 0;
				keennew = 1;
				calmnew = 2;
				daringnew = -1;
				wildnew = 0;
			}
			else if (statpackage === "dilettante") {
		
				hardnew = -1;
				keennew = 2;
				calmnew = 2;
				daringnew = -1;
				wildnew = 0;
			}
			else if (statpackage === "charlatan") {
		
				hardnew = -2;
				keennew = 4;
				calmnew = -2;
				daringnew = 2;
				wildnew = 0;
			}
			else if (statpackage === "jobber") {
		
				hardnew = 1;
				keennew = 1;
				calmnew = 1;
				daringnew = 1;
				wildnew = 0;
			}
			else if (statpackage === "worndown") {
		
				hardnew = 2;
				keennew = 2;
				calmnew = 2;
				daringnew = -4;
				wildnew = 0;
			}
			else if (statpackage === "newleaseonlife") {
		
				hardnew = 2;
				keennew = -1;
				calmnew = -1;
				daringnew = 2;
				wildnew = 0;
			}
			else if (statpackage === "safetyinspector") {
		
				hardnew = -2;
				keennew = 2;
				calmnew = 4;
				daringnew = -2;
				wildnew = 0;
			}
			
			setAttrs({
				hard: hardnew,
				keen: keennew,
				calm: calmnew,
				daring: daringnew,
				wild: wildnew
			});
		
		});
		
		
	});
	on("change:alt sheet:opened", function() {
        getAttrs(["alt"], function(values) {
            let a = parseInt(values.alt)||0;
            let hund = a % 10;
            let thou = a - hund;
            setAttrs({                            
		        alt100: hund,
			    alt1000: thou
		    });
        });
    });
    
    on("change:alt100 change:alt1000", function() {
        getAttrs(["alt100", "alt1000"], function(values) {
            let hund = parseInt(values.alt100)||0;
            let thou = parseInt(values.alt1000)||0;
            let a = hund + thou;
            setAttrs({                            
		        alt: a
		    });
        });
    });
    
    on("change:spd sheet:opened", function() {
        getAttrs(["spd"], function(values) {
            let s = parseInt(values.spd)||0;
            let tens = s % 10;
            let hund = s - tens;
            setAttrs({                            
		        spd10: tens,
			    spd100: hund
		    });
        });
    });
    
    on("change:spd10 change:spd100", function() {
        getAttrs(["spd10", "spd100"], function(values) {
            let tens = parseInt(values.spd10)||0;
            let hund = parseInt(values.spd100)||0;
            let s = hund + tens;
            setAttrs({                            
		        spd: s
		    });
        });
    })
	






// Custom Roll Parsing - for moves that need unique ones, generally with unique roll template too

//End of Night has a fully unique roll, and roll template

  const initiateRolleon = async function(event){
  
  let [section,rowID,button] = parseClickTrigger(event.triggerName);//Returns an array with values of ['repeating_section','rowID','button name']
    let message = `&{template:comrolleon} {{char=@{character_name}}} {{move=End of Night}} {{infodesc=@{endofnightdesc}}} {{showroll=[[1]]}} {{check=[[0[computed result]]]}} {{stressremoved=[[0[computed roll]]]}} {{misses=[[0[computed roll]]]}} {{roll1=[[1d20]]}} {{roll2=[[1d20]]}} {{roll3=[[1d20]]}} {{roll4=[[1d20]]}} {{roll5=[[1d20]]}} `;
    let roll = await startRoll(message);
    const computeObj = {};
  
  let rollResults = [1,2,3,4,5].map((num)=>roll.results[`roll${num}`]);
  console.log("Original rolls");
  console.log(rollResults);
  let result = rollResults.map(a => a.result);
  console.log("Original rolls - easier format");
  console.log(result);
  
  // Get vice, and reset it to zero
  getAttrs(["vice"], function(values) {
    let vice = parseInt(values.vice)||0;
	
        setAttrs({                            
		    vice: 0
		});
		
	  console.log("Vice count");
	  console.log(vice);
	  console.log("Number of results to match vice level");
	  const slicedArray = result.slice(0, vice);
	  console.log(slicedArray);
	  computeObj.check = slicedArray;
	  
	  //Count stress removed
	  console.log("16+ results");
	  let resultsStress2 = returnLarger(slicedArray, 15);
	  	  
	  console.log(resultsStress2);
	  console.log(resultsStress2.length);
	  
	  console.log("11-15 results");
	  let resultsStress1 = returnLarger(slicedArray, 10);
	  	  
	  console.log(resultsStress1);
	  console.log(resultsStress1.length - resultsStress2.length);
	  
	  computeObj.stressremoved = (resultsStress2.length*2) + (resultsStress1.length - resultsStress2.length);//16+ worth 2, 11-15 worth 1
	  
	  console.log("Misses");
	  
	  computeObj.misses = (slicedArray.length - resultsStress1.length);
	  
	  finishRoll(roll.rollId,computeObj);
	
	
  });
  
  
};
	
on('clicked:endofnight',initiateRolleon);
  
//Personal Attack - Offensive - flat roll

  const initiateRollpaoffensive = async function(event){
  
  let [section,rowID,button] = parseClickTrigger(event.triggerName);//Returns an array with values of ['repeating_section','rowID','button name']
    let message = `&{template:comrollpa} {{char=@{character_name}}} {{move=Personal Attack - Offensive}} {{infodesc=@{personalattackoffensivedesc}}} {{showroll=[[1]]}} {{check=[[0[computed result]]]}} {{raw=[[0[computed roll]]]}} {{modifier=[[0[computed roll]]]}} {{hitsregular=[[0[computed roll]]]}} {{hitsbetter=[[0[computed roll]]]}} {{crits=[[0[computed roll]]]}} {{natones=[[0[computed roll]]]}} {{roll1=[[1d20]]}} {{roll2=[[1d20]]}} {{roll3=[[1d20]]}} {{roll4=[[1d20]]}} {{roll5=[[1d20]]}} {{roll6=[[1d20]]}} {{roll7=[[1d20]]}} {{roll8=[[1d20]]}} {{roll9=[[1d20]]}} {{roll10=[[1d20]]}} `;
    let roll = await startRoll(message);
    const computeObj = {};
  
  let rollResults = [1,2,3,4,5,6,7,8,9,10].map((num)=>roll.results[`roll${num}`]);
  console.log("Original rolls");
  console.log(rollResults);
  let result = rollResults.map(a => a.result);
  console.log("Original rolls - easier format");
  console.log(result);
  
  // Get personal hits, to know how many d20s to use, plus fields that modify the roll
  getAttrs(["hitspersonal","hard","injury","roll_mod"], function(values) {
    let hitspersonal = parseInt(values.hitspersonal)||0;
	let hard = parseInt(values.hard)||0;
	let injury = parseInt(values.injury)||0;
	let rollmod = parseInt(values.roll_mod)||0;
	let modifier = hard - injury + rollmod;
	computeObj.modifier = modifier;
	
	let resultAdjusted = result.map(n => n + modifier);
		
	  console.log("Hit count");
	  console.log(hitspersonal);
	  console.log("Number of results to match hit count");
	  const slicedArray = result.slice(0, hitspersonal);
	  const slicedArrayAdjusted = resultAdjusted.slice(0, hitspersonal);
	  console.log(slicedArray);
	  computeObj.raw = slicedArray;
	  computeObj.check = slicedArrayAdjusted;
	  
	  //Count hits
	  console.log("16+ results");
	  let resultsBetterHits = returnLarger(slicedArrayAdjusted, 15);
	  	  
	  console.log(resultsBetterHits);
	  console.log(resultsBetterHits.length);
	  computeObj.hitsbetter = resultsBetterHits.length;
	  
	  console.log("11-15 results");
	  let resultsHits = returnLarger(slicedArrayAdjusted, 10);
	  	  
	  console.log(resultsHits);
	  console.log(resultsHits.length - resultsBetterHits.length);
	  computeObj.hitsregular = resultsHits.length;
	  
	  console.log("Crits");
	  let resultsCrits = returnLarger(slicedArray, 19);
	  computeObj.crits = resultsCrits.length;
	  
	  console.log("Nat Ones");
	  let resultsNotOnes = returnLarger(slicedArray, 1);
	  
	  computeObj.natones = (slicedArray.length - resultsNotOnes.length);
	  
	  finishRoll(roll.rollId,computeObj);
	
	
  });
  
  
};
	
on('clicked:personalattackoffensive',initiateRollpaoffensive);

//Personal Attack - Offensive - advantage roll

  const initiateRollpaoffensiveadv = async function(event){
  
  let [section,rowID,button] = parseClickTrigger(event.triggerName);//Returns an array with values of ['repeating_section','rowID','button name']
    let message = `&{template:comrollpa} {{char=@{character_name}}} {{move=Personal Attack - Offensive}} {{infodesc=@{personalattackoffensivedesc}}} {{showroll=[[1]]}} {{check=[[0[computed result]]]}} {{raw=[[0[computed roll]]]}} {{modifier=[[0[computed roll]]]}} {{hitsregular=[[0[computed roll]]]}} {{hitsbetter=[[0[computed roll]]]}} {{crits=[[0[computed roll]]]}} {{natones=[[0[computed roll]]]}} {{droppeddie=[[0[computed roll]]]}} {{roll1=[[1d20]]}} {{roll2=[[1d20]]}} {{roll3=[[1d20]]}} {{roll4=[[1d20]]}} {{roll5=[[1d20]]}} {{roll6=[[1d20]]}} {{roll7=[[1d20]]}} {{roll8=[[1d20]]}} {{roll9=[[1d20]]}} {{roll10=[[1d20]]}}  {{roll11=[[1d20]]}} `;
    let roll = await startRoll(message);
    const computeObj = {};
  
  let rollResults = [1,2,3,4,5,6,7,8,9,10,11].map((num)=>roll.results[`roll${num}`]);
  console.log("Original rolls");
  console.log(rollResults);
  let result = rollResults.map(a => a.result);
  console.log("Original rolls - easier format");
  console.log(result);
  
  // Get personal hits, to know how many d20s to use, plus fields that modify the roll
  getAttrs(["hitspersonal","hard","injury","roll_mod"], function(values) {
    let hitspersonal = parseInt(values.hitspersonal)||0;
	let hard = parseInt(values.hard)||0;
	let injury = parseInt(values.injury)||0;
	let rollmod = parseInt(values.roll_mod)||0;
	let modifier = hard - injury + rollmod;
	computeObj.modifier = modifier;
	
	let resultAdjusted = result.map(n => n + modifier);
		
	  console.log("Hit count");
	  console.log(hitspersonal);
	  console.log("Number of results to match hit count");
	  const slicedArray = result.slice(0, hitspersonal);
	  const slicedArrayAdjusted = resultAdjusted.slice(0, hitspersonal);
	  
	  var min1 = Math.min.apply(null, slicedArray); // get the min of the array
	  console.log("Min die");
	  console.log(min1);
	  slicedArray.splice(slicedArray.indexOf(min1), 1); // remove min from the array
	  computeObj.droppeddie = min1;
	  
	  var min1 = Math.min.apply(null, slicedArrayAdjusted); // get the min of the array
	  console.log("Min die");
	  console.log(min1);
	  slicedArrayAdjusted.splice(slicedArrayAdjusted.indexOf(min1), 1); // remove min from the array
	  
	  console.log(slicedArray);
	  computeObj.raw = slicedArray;
	  computeObj.check = slicedArrayAdjusted;
	  
	  //Count hits
	  console.log("16+ results");
	  let resultsBetterHits = returnLarger(slicedArrayAdjusted, 15);
	  	  
	  console.log(resultsBetterHits);
	  console.log(resultsBetterHits.length);
	  computeObj.hitsbetter = resultsBetterHits.length;
	  
	  console.log("11-15 results");
	  let resultsHits = returnLarger(slicedArrayAdjusted, 10);
	  	  
	  console.log(resultsHits);
	  console.log(resultsHits.length - resultsBetterHits.length);
	  computeObj.hitsregular = resultsHits.length;
	  
	  console.log("Crits");
	  let resultsCrits = returnLarger(slicedArray, 19);
	  computeObj.crits = resultsCrits.length;
	  
	  console.log("Nat Ones");
	  let resultsNotOnes = returnLarger(slicedArray, 1);
	  
	  computeObj.natones = (slicedArray.length - resultsNotOnes.length);
	  
	  finishRoll(roll.rollId,computeObj);
	
	
  });
  
  
};
	
on('clicked:advpersonalattackoffensive',initiateRollpaoffensiveadv);

//Personal Attack - Offensive - disadvantage roll

  const initiateRollpaoffensivedis = async function(event){
  
  let [section,rowID,button] = parseClickTrigger(event.triggerName);//Returns an array with values of ['repeating_section','rowID','button name']
    let message = `&{template:comrollpa} {{char=@{character_name}}} {{move=Personal Attack - Offensive}} {{infodesc=@{personalattackoffensivedesc}}} {{showroll=[[1]]}} {{check=[[0[computed result]]]}} {{raw=[[0[computed roll]]]}} {{modifier=[[0[computed roll]]]}} {{hitsregular=[[0[computed roll]]]}} {{hitsbetter=[[0[computed roll]]]}} {{crits=[[0[computed roll]]]}} {{natones=[[0[computed roll]]]}} {{droppeddie=[[0[computed roll]]]}} {{roll1=[[1d20]]}} {{roll2=[[1d20]]}} {{roll3=[[1d20]]}} {{roll4=[[1d20]]}} {{roll5=[[1d20]]}} {{roll6=[[1d20]]}} {{roll7=[[1d20]]}} {{roll8=[[1d20]]}} {{roll9=[[1d20]]}} {{roll10=[[1d20]]}}  {{roll11=[[1d20]]}} `;
    let roll = await startRoll(message);
    const computeObj = {};
  
  let rollResults = [1,2,3,4,5,6,7,8,9,10,11].map((num)=>roll.results[`roll${num}`]);
  console.log("Original rolls");
  console.log(rollResults);
  let result = rollResults.map(a => a.result);
  console.log("Original rolls - easier format");
  console.log(result);
  
  // Get personal hits, to know how many d20s to use, plus fields that modify the roll
  getAttrs(["hitspersonal","hard","injury","roll_mod"], function(values) {
    let hitspersonal = parseInt(values.hitspersonal)||0;
	let hard = parseInt(values.hard)||0;
	let injury = parseInt(values.injury)||0;
	let rollmod = parseInt(values.roll_mod)||0;
	let modifier = hard - injury + rollmod;
	computeObj.modifier = modifier;
	
	let resultAdjusted = result.map(n => n + modifier);
		
	  console.log("Hit count");
	  console.log(hitspersonal);
	  console.log("Number of results to match hit count");
	  const slicedArray = result.slice(0, hitspersonal);
	  const slicedArrayAdjusted = resultAdjusted.slice(0, hitspersonal);
	  
	  var max1 = Math.max.apply(null, slicedArray); // get the max of the array
	  console.log("Max die");
	  console.log(max1);
	  slicedArray.splice(slicedArray.indexOf(max1), 1); // remove max from the array
	  computeObj.droppeddie = max1;
	  
	  var max1 = Math.max.apply(null, slicedArrayAdjusted); // get the max of the array
	  console.log("Max die");
	  console.log(max1);
	  slicedArrayAdjusted.splice(slicedArrayAdjusted.indexOf(max1), 1); // remove max from the array
	  
	  console.log(slicedArray);
	  computeObj.raw = slicedArray;
	  computeObj.check = slicedArrayAdjusted;
	  
	  //Count hits
	  console.log("16+ results");
	  let resultsBetterHits = returnLarger(slicedArrayAdjusted, 15);
	  	  
	  console.log(resultsBetterHits);
	  console.log(resultsBetterHits.length);
	  computeObj.hitsbetter = resultsBetterHits.length;
	  
	  console.log("11-15 results");
	  let resultsHits = returnLarger(slicedArrayAdjusted, 10);
	  	  
	  console.log(resultsHits);
	  console.log(resultsHits.length - resultsBetterHits.length);
	  computeObj.hitsregular = resultsHits.length;
	  
	  console.log("Crits");
	  let resultsCrits = returnLarger(slicedArray, 19);
	  computeObj.crits = resultsCrits.length;
	  
	  console.log("Nat Ones");
	  let resultsNotOnes = returnLarger(slicedArray, 1);
	  
	  computeObj.natones = (slicedArray.length - resultsNotOnes.length);
	  
	  finishRoll(roll.rollId,computeObj);
	
	
  });
  
  
};
	
on('clicked:dispersonalattackoffensive',initiateRollpaoffensivedis);




//Personal Attack - Defensive - flat roll

  const initiateRollpadefensive = async function(event){
  
  let [section,rowID,button] = parseClickTrigger(event.triggerName);//Returns an array with values of ['repeating_section','rowID','button name']
    let message = `&{template:comrollpa} {{char=@{character_name}}} {{move=Personal Attack - Defensive}} {{infodesc=@{personalattackdefensivedesc}}} {{showroll=[[1]]}} {{check=[[0[computed result]]]}} {{raw=[[0[computed roll]]]}} {{modifier=[[0[computed roll]]]}} {{hitsregular=[[0[computed roll]]]}} {{hitsbetter=[[0[computed roll]]]}} {{crits=[[0[computed roll]]]}} {{natones=[[0[computed roll]]]}} {{roll1=[[1d20]]}} {{roll2=[[1d20]]}} {{roll3=[[1d20]]}} {{roll4=[[1d20]]}} {{roll5=[[1d20]]}} {{roll6=[[1d20]]}} {{roll7=[[1d20]]}} {{roll8=[[1d20]]}} {{roll9=[[1d20]]}} {{roll10=[[1d20]]}} `;
    let roll = await startRoll(message);
    const computeObj = {};
  
  let rollResults = [1,2,3,4,5,6,7,8,9,10].map((num)=>roll.results[`roll${num}`]);
  console.log("Original rolls");
  console.log(rollResults);
  let result = rollResults.map(a => a.result);
  console.log("Original rolls - easier format");
  console.log(result);
  
  // Get personal hits, to know how many d20s to use, plus fields that modify the roll
  getAttrs(["hitspersonal","keen","injury","roll_mod"], function(values) {
    let hitspersonal = parseInt(values.hitspersonal)||0;
	let keen = parseInt(values.keen)||0;
	let injury = parseInt(values.injury)||0;
	let rollmod = parseInt(values.roll_mod)||0;
	let modifier = -keen + injury + rollmod;
	computeObj.modifier = modifier;
	
	let resultAdjusted = result.map(n => n + modifier);
		
	  console.log("Hit count");
	  console.log(hitspersonal);
	  console.log("Number of results to match hit count");
	  const slicedArray = result.slice(0, hitspersonal);
	  const slicedArrayAdjusted = resultAdjusted.slice(0, hitspersonal);
	  console.log(slicedArray);
	  computeObj.raw = slicedArray;
	  computeObj.check = slicedArrayAdjusted;
	  
	  //Count hits
	  console.log("16+ results");
	  let resultsBetterHits = returnLarger(slicedArrayAdjusted, 15);
	  	  
	  console.log(resultsBetterHits);
	  console.log(resultsBetterHits.length);
	  computeObj.hitsbetter = resultsBetterHits.length;
	  
	  console.log("11-15 results");
	  let resultsHits = returnLarger(slicedArrayAdjusted, 10);
	  	  
	  console.log(resultsHits);
	  console.log(resultsHits.length - resultsBetterHits.length);
	  computeObj.hitsregular = resultsHits.length;
	  
	  console.log("Crits");
	  let resultsCrits = returnLarger(slicedArray, 19);
	  computeObj.crits = resultsCrits.length;
	  
	  console.log("Nat Ones");
	  let resultsNotOnes = returnLarger(slicedArray, 1);
	  
	  computeObj.natones = (slicedArray.length - resultsNotOnes.length);
	  
	  finishRoll(roll.rollId,computeObj);
	
	
  });
  
  
};
	
on('clicked:personalattackdefensive',initiateRollpadefensive);


//Personal Attack - Defensive - advantage roll

  const initiateRollpadefensiveadv = async function(event){
  
  let [section,rowID,button] = parseClickTrigger(event.triggerName);//Returns an array with values of ['repeating_section','rowID','button name']
    let message = `&{template:comrollpa} {{char=@{character_name}}} {{move=Personal Attack - Defensive}} {{infodesc=@{personalattackdefensivedesc}}} {{showroll=[[1]]}} {{check=[[0[computed result]]]}} {{raw=[[0[computed roll]]]}} {{modifier=[[0[computed roll]]]}} {{hitsregular=[[0[computed roll]]]}} {{hitsbetter=[[0[computed roll]]]}} {{crits=[[0[computed roll]]]}} {{natones=[[0[computed roll]]]}} {{droppeddie=[[0[computed roll]]]}} {{roll1=[[1d20]]}} {{roll2=[[1d20]]}} {{roll3=[[1d20]]}} {{roll4=[[1d20]]}} {{roll5=[[1d20]]}} {{roll6=[[1d20]]}} {{roll7=[[1d20]]}} {{roll8=[[1d20]]}} {{roll9=[[1d20]]}} {{roll10=[[1d20]]}}  {{roll11=[[1d20]]}} `;
    let roll = await startRoll(message);
    const computeObj = {};
  
  let rollResults = [1,2,3,4,5,6,7,8,9,10,11].map((num)=>roll.results[`roll${num}`]);
  console.log("Original rolls");
  console.log(rollResults);
  let result = rollResults.map(a => a.result);
  console.log("Original rolls - easier format");
  console.log(result);
  
  // Get personal hits, to know how many d20s to use, plus fields that modify the roll
  getAttrs(["hitspersonal","keen","injury","roll_mod"], function(values) {
    let hitspersonal = parseInt(values.hitspersonal)||0;
	let keen = parseInt(values.keen)||0;
	let injury = parseInt(values.injury)||0;
	let rollmod = parseInt(values.roll_mod)||0;
	let modifier = -keen + injury + rollmod;
	computeObj.modifier = modifier;
	
	let resultAdjusted = result.map(n => n + modifier);
		
	  console.log("Hit count");
	  console.log(hitspersonal);
	  console.log("Number of results to match hit count");
	  const slicedArray = result.slice(0, hitspersonal);
	  const slicedArrayAdjusted = resultAdjusted.slice(0, hitspersonal);
	  
	  var min1 = Math.min.apply(null, slicedArray); // get the min of the array
	  console.log("Min die");
	  console.log(min1);
	  slicedArray.splice(slicedArray.indexOf(min1), 1); // remove min from the array
	  computeObj.droppeddie = min1;
	  
	  var min1 = Math.min.apply(null, slicedArrayAdjusted); // get the min of the array
	  console.log("Min die");
	  console.log(min1);
	  slicedArrayAdjusted.splice(slicedArrayAdjusted.indexOf(min1), 1); // remove min from the array
	  
	  console.log(slicedArray);
	  computeObj.raw = slicedArray;
	  computeObj.check = slicedArrayAdjusted;
	  
	  //Count hits
	  console.log("16+ results");
	  let resultsBetterHits = returnLarger(slicedArrayAdjusted, 15);
	  	  
	  console.log(resultsBetterHits);
	  console.log(resultsBetterHits.length);
	  computeObj.hitsbetter = resultsBetterHits.length;
	  
	  console.log("11-15 results");
	  let resultsHits = returnLarger(slicedArrayAdjusted, 10);
	  	  
	  console.log(resultsHits);
	  console.log(resultsHits.length - resultsBetterHits.length);
	  computeObj.hitsregular = resultsHits.length;
	  
	  console.log("Crits");
	  let resultsCrits = returnLarger(slicedArray, 19);
	  computeObj.crits = resultsCrits.length;
	  
	  console.log("Nat Ones");
	  let resultsNotOnes = returnLarger(slicedArray, 1);
	  
	  computeObj.natones = (slicedArray.length - resultsNotOnes.length);
	  
	  finishRoll(roll.rollId,computeObj);
	
	
  });
  
  
};
	
on('clicked:advpersonalattackdefensive',initiateRollpadefensiveadv);

//Personal Attack - Defensive - disadvantage roll

  const initiateRollpadefensivedis = async function(event){
  
  let [section,rowID,button] = parseClickTrigger(event.triggerName);//Returns an array with values of ['repeating_section','rowID','button name']
    let message = `&{template:comrollpa} {{char=@{character_name}}} {{move=Personal Attack - Defensive}} {{infodesc=@{personalattackdefensivedesc}}} {{showroll=[[1]]}} {{check=[[0[computed result]]]}} {{raw=[[0[computed roll]]]}} {{modifier=[[0[computed roll]]]}} {{hitsregular=[[0[computed roll]]]}} {{hitsbetter=[[0[computed roll]]]}} {{crits=[[0[computed roll]]]}} {{natones=[[0[computed roll]]]}} {{droppeddie=[[0[computed roll]]]}} {{roll1=[[1d20]]}} {{roll2=[[1d20]]}} {{roll3=[[1d20]]}} {{roll4=[[1d20]]}} {{roll5=[[1d20]]}} {{roll6=[[1d20]]}} {{roll7=[[1d20]]}} {{roll8=[[1d20]]}} {{roll9=[[1d20]]}} {{roll10=[[1d20]]}}  {{roll11=[[1d20]]}} `;
    let roll = await startRoll(message);
    const computeObj = {};
  
  let rollResults = [1,2,3,4,5,6,7,8,9,10,11].map((num)=>roll.results[`roll${num}`]);
  console.log("Original rolls");
  console.log(rollResults);
  let result = rollResults.map(a => a.result);
  console.log("Original rolls - easier format");
  console.log(result);
  
  // Get personal hits, to know how many d20s to use, plus fields that modify the roll
  getAttrs(["hitspersonal","keen","injury","roll_mod"], function(values) {
    let hitspersonal = parseInt(values.hitspersonal)||0;
	let keen = parseInt(values.keen)||0;
	let injury = parseInt(values.injury)||0;
	let rollmod = parseInt(values.roll_mod)||0;
	let modifier = -keen + injury + rollmod;
	computeObj.modifier = modifier;
	
	let resultAdjusted = result.map(n => n + modifier);
		
	  console.log("Hit count");
	  console.log(hitspersonal);
	  console.log("Number of results to match hit count");
	  const slicedArray = result.slice(0, hitspersonal);
	  const slicedArrayAdjusted = resultAdjusted.slice(0, hitspersonal);
	  
	  var max1 = Math.max.apply(null, slicedArray); // get the max of the array
	  console.log("Max die");
	  console.log(max1);
	  slicedArray.splice(slicedArray.indexOf(max1), 1); // remove max from the array
	  computeObj.droppeddie = max1;
	  
	  var max1 = Math.max.apply(null, slicedArrayAdjusted); // get the max of the array
	  console.log("Max die");
	  console.log(max1);
	  slicedArrayAdjusted.splice(slicedArrayAdjusted.indexOf(max1), 1); // remove max from the array
	  
	  console.log(slicedArray);
	  computeObj.raw = slicedArray;
	  computeObj.check = slicedArrayAdjusted;
	  
	  //Count hits
	  console.log("16+ results");
	  let resultsBetterHits = returnLarger(slicedArrayAdjusted, 15);
	  	  
	  console.log(resultsBetterHits);
	  console.log(resultsBetterHits.length);
	  computeObj.hitsbetter = resultsBetterHits.length;
	  
	  console.log("11-15 results");
	  let resultsHits = returnLarger(slicedArrayAdjusted, 10);
	  	  
	  console.log(resultsHits);
	  console.log(resultsHits.length - resultsBetterHits.length);
	  computeObj.hitsregular = resultsHits.length;
	  
	  console.log("Crits");
	  let resultsCrits = returnLarger(slicedArray, 19);
	  computeObj.crits = resultsCrits.length;
	  
	  console.log("Nat Ones");
	  let resultsNotOnes = returnLarger(slicedArray, 1);
	  
	  computeObj.natones = (slicedArray.length - resultsNotOnes.length);
	  
	  finishRoll(roll.rollId,computeObj);
	
	
  });
  
  
};
	
on('clicked:dispersonalattackdefensive',initiateRollpadefensivedis);
	
	
</script>
